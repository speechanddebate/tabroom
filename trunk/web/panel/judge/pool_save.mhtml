<%args>
	$tourn
	$account
	$pool_id => undef
</%args>
<%init>

	my $pool;

	my $site_id = $ARGS{"site_id"};
	$site_id = 0 unless $site_id;
	
	if ($pool_id) { 

		$pool = Tab::Pool->retrieve($pool_id);

		$pool->site($site_id);
		$pool->name($ARGS{"name"});
		$pool->standby($ARGS{"standby"});
		$pool->standby_timeslot($ARGS{"standby_timeslot"});
		$pool->publish($ARGS{"publish"});
		$pool->registrant($ARGS{"registrant"});
		$pool->burden($ARGS{"burden"});
		$pool->judge_group($ARGS{"judge_group_id"});
		$pool->event_based($ARGS{"event_based"});
		$pool->update();

	} else { 

		$pool = Tab::Pool->create({
			name => $ARGS{"name"},
			site => $site_id,
			tourn => $tourn->id,
			standby => $ARGS{"standby"},
			standby_timeslot => $ARGS{"standby_timeslot"},
			publish => $ARGS{"publish"},
			registrant => $ARGS{"registrant"},
			burden => $ARGS{"burden"},
			judge_group => $ARGS{"judge_group_id"},
			event_based => $ARGS{"event_based"}
		});

	}

	my $msg = "Pool ".$pool->name." details have been saved.";
	$m->redirect("pool.mhtml?pool_id=".$pool->id."&msg=$msg");

</%init>

