<%args>
	$event_id
</%args>

<%init>

	my $event=Tab::Event->retrieve($event_id);	
	my $group = $event->judge_group;
	my $group_id=$group->id;

	Tab::Panel->columns(TEMP => "judge_last");
	Tab::Panel->columns(TEMP => "judge_first");
	Tab::Panel->columns(TEMP => "team_name");
	Tab::Panel->columns(TEMP => "round_name");
	Tab::Panel->set_sql( panels => "
		select judge.last as judge_last, judge.first as judge_first, entry.name as team_name, round.name as round_name
		from judge, ballot, entry, panel, round
		where judge.id=ballot.judge
		and entry.id=ballot.entry
		and judge.judge_group=$group_id
		and panel.id=ballot.panel
		and round.id=panel.round
		order by judge.last, round.name
	");

	my @panels = Tab::Panel->search_panels;
	
</%init>

	<div class="menu">

		<div class="sidenote">

			<h4>Back to report</h4>

			<a class="blue block" href="index.mhtml">
				Panel Reports
			</a>

		</div>

	</div>
	
	<div class="main">
	
		<& /funclib/tablesorter.mas, table => "sortme" &>

		<h2>Preset Draw</h2>

		<table id="sortme">

			<thead>
			
			<tr class="yellowrow">
				<th class="smaller">
					Round
				</th>
				
				<th class="smallish">
					Judge
				</th>

				<th class="smallish" style="width: 130px;">
					Team
				</th>

			</tr>
		
			</thead>
			<tbody>
			
%			foreach my $panel (@panels) {

			<tr>
				<td>
					<% $panel->round_name %> 
				</td>


				<td>
					<% $panel->judge_last %>,<% $panel->judge_first %>
				</td>
				<td>
					<% $panel->team_name %>
				</td>

			</tr>
			
%			}

			</tbody>
			
		</table>
		
	</div>
