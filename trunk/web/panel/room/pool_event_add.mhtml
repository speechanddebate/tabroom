<%args>
	$pool_id      => undef
	$event_id     => undef
	$prelims_only => undef
</%args>
<%init>

	my $event = Tab::Event->retrieve($event_id);

	my @rounds = $event->rounds;

	foreach my $round (@rounds) { 

		next if $prelims_only && $round->type eq "elim";
		next if $prelims_only && $round->type eq "final";
		next if Tab::RoomGroupRound->search( round => $round->id, room_group => $pool_id );

		Tab::RoomGroupRound->create({
			round => $round->id,
			room_group => $pool_id
		});

	}

	my $msg = "All ";
	$msg = "Prelim " if $prelims_only;
	$msg .= "rounds of ".$event->name." will draw from this judge pool";
	$m->redirect("edit_pools.mhtml?msg=$msg");

</%init>
