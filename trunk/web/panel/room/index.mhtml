<%args>
	$tourn
	$account
	$timeslot_id => undef
</%args>
<%init>

	my $timeslot = Tab::Timeslot->retrieve($timeslot_id);
	my @rounds = $timeslot->rounds if $timeslot;

	my @panels = $m->comp("/funclib/timeslot_panels.mas", timeslot => $timeslot) if $timeslot;
	my @rooms = $m->comp("/funclib/timeslot_rooms.mas", timeslot => $timeslot) if $timeslot;

	my %room_by_id = ();
	foreach my $room (@rooms) { 
		$room_by_id{$room->id} = $room;
	}

	my %panels_by_round = ();

	foreach my $panel (@panels) { 
		push(@{$panels_by_round{$panel->round->id}}, $panel);
	}

	my @strikes = $m->comp("/funclib/tourn_roomstrikes.mas", tourn => $tourn);
	my %strikes_by_room = ();

	foreach my $strike (@strikes) { 
		push (@{$strikes_by_room{$strike->room->id}}, $strike);
	}

	my @clean_rooms = $m->comp("/funclib/timeslot_rooms.mas", timeslot => $timeslot, avail => 1);
#	my @room_pools = $m->comp("/funclib/timeslot_room_pools.mas");

</%init>

	<& menu.mas, tourn => $tourn, timeslot => $timeslot, clean_rooms => \@clean_rooms &>

	<div class="left huge">

		<h2>Rooms <% $timeslot ? " during ".$timeslot->name : "" %></h2>

%		foreach my $round (@rounds) { 

%			my @panels = @{$panels_by_round{$round->id}} if $round->id && $panels_by_round{$round->id};

			<h4><% $round->realname %> of <% $round->event->name %></h4>

%			foreach  my $panel (@panels) { 
				<span class="quarterspan blue nowrap">
					<% $panel->letter %>. <% $room_by_id{$panel->room->id}? $room_by_id{$panel->room->id}->name : "None" %>
				</span>
%			}
			
			<br style="clear: both;">

%		}

	</div>




