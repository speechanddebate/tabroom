<%args>
	$room_id
	$panel_id
	$round_id
</%args>
<%init>

	Tab::debuglog("Room $room_id Panel $panel_id Round $round_id");

	$panel_id =~ s/room_//g;

	my ($roomid, $flight) = split(/\_/, $room_id);

	my $panel = Tab::Panel->retrieve($panel_id);
	my $room = Tab::Room->retrieve($roomid);

	if ($panel_id eq "out") { 
		
		my @already_panels = Tab::Panel->search( room => $roomid, round => $round_id, flight => $flight);

		foreach my $panel (@already_panels) { 
			$panel->room("");
			$panel->update;
		}

	} elsif ($room) { 

		$panel->room($room_id);
		$panel->update;

	}


	return;

</%init>
