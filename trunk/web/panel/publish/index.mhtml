<%args>
	$tourn
	$event_id => undef
</%args>
<%init>

	my $event = Tab::Event->retrieve($event_id) if $event_id;

	my @events = sort {$a->name cmp $b->name} $tourn->events;
	$event = $events[0] if @events &! $event;

	my $switch;

</%init>

	<div class="left huge">

%		if ($event) { 

			<h2>Publish <% $event->name %></h2>

			<table cellpadding="4" cellspacing="1">

				<tr class="yellowrow">
					
					<th class="smaller centeralign padno">
						Rnd
					</th>

					<th class="smaller">
						Pairing
					</th>

					<th class="smaller">
						Results 
						<form action="save.mhtml" method="post">
						<input type="hidden" name="event_id" value="<% $event->id %>">
					</th>

				</tr>

%				foreach my $round (sort {$a->name <=> $b->name} $event->rounds) { 

					<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

						<td class="smaller centeralign padno">
							<% $round->name %>
						</td>

						<td class="smallish padno">

							<span class="hundo">
								<input type="radio" name="publish_<% $round->id %>" id="publish_<% $round->id %>_0" value="0"  <% $round->published ? "" : 'checked="checked"' %>>
								<label for="publish_<% $round->id %>_0">
									Not Public
								</label>
							</span>

							<span class="hundo">
								<input type="radio" name="publish_<% $round->id %>" id="publish_<% $round->id %>_1" value="1"  <% $round->published == 1 ? 'checked="checked"' : "" %>> 
								<label for="publish_<% $round->id %>_1">
									Public
								</label>
							</span>

							<span class="hundo">
								<input type="radio" name="publish_<% $round->id %>" id="publish_<% $round->id %>_2" value="2"  <% $round->published == 2 ? 'checked="checked"' : "" %>>
								<label for="publish_<% $round->id %>_2">
									w/o judges
								</label>
							</span>

%							if ($event->type eq "wudc") { 
								<span class="hundo">
									<input type="radio" name="publish_<% $round->id %>" id="publish_<% $round->id %>_3" value="3"  <% $round->published == 3 ? 'checked="checked"' : "" %>> 
									<label for="publish_<% $round->id %>_3">
										w/Motion
									</label>
								</span>
%							}
						</td>

						<td class="smallish padno nowrap">
							<span class="hundo">
								<input type="radio" name="result_<% $round->id %>" id="result_<% $round->id %>_0" value="0" <% $round->post_results == 0 ? "checked" : "" %>>
								<label for="result_<% $round->id %>_0">
									Not Public
								</label>
							</span>

							<span class="hundo">
								<input type="radio" name="result_<% $round->id %>" id="result_<% $round->id %>_1" value="1" <% $round->post_results == 1 ? "checked" : "" %>>
								<label for="result_<% $round->id %>_1">
									Records
								</label>
							</span>

							<span class="hundo">
								<input type="radio" name="result_<% $round->id %>" id="result_<% $round->id %>_2" value="2" <% $round->post_results == 2 ? "checked" : "" %>>
								<label for="result_<% $round->id %>_2">
									All results
								</label>
							</span>

						</td>

					</tr>

%				}

				<tr class="liblrow">

					<td colspan="4" class="rightalign">
						<input class='thin' type="submit" value=" Save Publish Settings ">
						</form>
					</td>

				</tr>

			</table>

%		}

	</div>

	<div class="right small">
	
		<div class="sidenote">

			<h4>Events</h4>

%				@events = sort {$a->type cmp $b->type} @events;
%				my $last_type;

%				foreach my $oevent (@events) { 

%					$last_type = $oevent->type unless $last_type;
%					my $class = "martop" if $oevent->type ne $last_type;
%					$last_type = $oevent->type;

					<a class="<% $oevent->id == $event_id? "dk" : ""%>blue nowrap <% $class %> block" href="index.mhtml?event_id=<% $oevent->id %>">
						<% $oevent->name %>
					</a>
%				}

		</div>

	</div>
		
