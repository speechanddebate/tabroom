<%args>
	$tourn
</%args>

<%init>
	my @events = $m->comp("/funclib/tourn_events.mas", tourn => $tourn);
	@events = sort { $a->name cmp $b->name } @events;

</%init>

	<div class="left huge">

		<h2>Paneling <% $tourn->name %></h2>

		<table cellpadding="5" width="100%" cellspacing="1">

			<tr class="liblrow">

				<th>
					Event
				</th>

				<th>
					Entries
				</th>

				<th>
					Prelims
				</th>	

				<th>
					Panel
				</th>

			</tr>

%		my $switch;

% 		foreach my $event (@events) { 

% 			my @panels = $event->panels(type => "prelim");
% 			my @rounds = Tab::Round->search( event => $event->id, type => "prelim");

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					<% $event->name %>
				</td>
					
				<td class="centeralign">
					<% $event->count %>
				</td>

% 				if (@rounds) {

					<td class="centeralign">
						<a href="/panel/event_schedule.mhtml?event_id=<% $event->id %>">
							<% scalar @rounds %> set
						</a>
					</td>

					<td class="centeralign">
						
% 						if ($event->type eq "speech") { 
							<form action="panel_size_speech.mhtml" method="post">
%						}

%	 					if ($event->type eq "debate") { 
							<form action="panel_debate.mas" method="post">
%						}

% 						if ($event->type eq "congress") { 
							<form action="panel_size_congress.mhtml" method="post">
%						}

						<input type="hidden" name="event_id" value="<% $event->id %>">
						<input  type="submit" value="<% (@panels) ? '  Repanel  ' : '   Panel  ' %>">
						</form>

					</td>

%				} else { 

					<td class="centeralign">
						<form action="/panel/event_schedule.mhtml" method="post">
						<input  type="submit" value="  Schedule  ">
						<input type="hidden" name="event_id" value="<% $event->id %>">
						</form>
					</td>

					<td>
					</td>

%				}

			</tr>
	
%		}

		</table>

	</div>


