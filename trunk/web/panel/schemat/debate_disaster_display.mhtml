<%args>
	$round_id
</%args>
<%init>
    use Time::HiRes qw( time );
    my $start = time(); 

	my $round = Tab::Round->retrieve($round_id);

    my ($any_problem, $double_booked_judges, $sides_uneven, $unscheduled_teams, $double_scheduled_teams, $same_school_debates, $judgeless_debates, $roomless_panels, $hit_before, $judge_preclusion, $judge_timestrike, $hired_judging_me) = $m->comp("/funclib/debate_disaster_check.mas", round_id => $round_id );
</%init>

<div class="main">

<& /funclib/tablesorter.mas, table => "sortme" &>

<div class="full nospace">
	<span class="half">
		<h2><% $round->realname %> disaster checks</h2>
	</span>
	<span class="half rightalign nospace">
		<a class="dkblue padmuchmore twofifth" href="/panel/schemat/show.mhtml?round_id=<% $round_id %>">
			Return to Pairings
		</a>
	</span>
</div>

<div class="full centeralign">
	<h4 class="redtext">Status: <% $any_problem %></h4>
</div>

<table id="sortme">
    <thead>
    <tr class="yellowrow">
    <th>Issue</th>
    <th>Status</th>
    </tr>
    </thead>
    
    <tbody>
    
    <tr>
        <td width="50">Double-booked judges</td>
        <td width="50">
%       if ($double_booked_judges) { print $double_booked_judges; } else { print "OK"; }         
        </td>
    </tr>
    <tr>
        <td>Side equalizations</td>
        <td>
%       if ($sides_uneven) { print $sides_uneven; } else { print "OK"; }         
        </td>
    </tr>
    <tr>
        <td>Unscheduled teams</td>
        <td>
%       if ($unscheduled_teams) { print $unscheduled_teams; } else { print "OK"; }         
        </td>
    </tr>
    <tr>
        <td>Double scheduled teams</td>
        <td>
%       if ($double_scheduled_teams) { print $double_scheduled_teams; } else { print "OK"; }         
        </td>

    </tr>
    <tr>
        <td>
			Teams from same school debating each other <p class="marno explain">Shows even if same-school debates are allowed</p></td>
        <td>
%       if ($same_school_debates) { print $same_school_debates; } else { print "OK"; }         
        </td>

    </tr>
    <tr class="<% $judgeless_debates ? "lirdrow" : "" %>">
        <td>Debates Without Judges</td>
        <td>
%       if ($judgeless_debates) { print $judgeless_debates; } else { print "OK"; }         
        </td>

    </tr>
	<tr class="<% $roomless_panels ? "lirdrow" : "" %>">
        <td>Debates Without Rooms</td>
        <td>
%       if ($roomless_panels) { print $roomless_panels; } else { print "OK"; }         
        </td>

    </tr>
    <tr>
        <td>Teams hitting a second time <p class="marno explain">Only works if judges have been assigned; also shows same-school debates</p></td>
        <td>
%       if ($hit_before) { print $hit_before; } else { print "OK"; }         
        </td>

    </tr>
    <tr>
        <td>Judges hearing teams that they are precluded from hearing</td>
        <td>
%       if ($judge_preclusion) { print $judge_preclusion; } else { print "OK"; }         
        </td>

    </tr>

    <tr>
        <td>Judges assigned but unavailble for timeslot</td>
        <td>
%       if ($judge_timestrike) { print $judge_timestrike; } else { print "OK"; }         
        </td>
    </tr>

	<tr class="<% $hired_judging_me ? "lirdrow" : "" %>">
        <td>Judges judging entries who hired them</td>
        <td>
%       if ($hired_judging_me) { print $hired_judging_me; } else { print "OK"; }         
        </td>
    </tr>

    </tbody>
    
</table>

</div>

<br>

% my $end = time();
% print " Check run in:  "; printf("%.2f\n", $end - $start); print "<br>";


