<%args>
	$account
	$event_id
	$tourn
	$certain => undef
</%args>
<%init>

	my $event = Tab::Event->retrieve($event_id); 

	unless ($event) { 
		my $err = "There was no event specified that you can delete.  Perhaps you already deleted it?";
		$m->redirect("/setup/event/edit.mhtml?err=$err");
	}

	my $c_tourn = $event->tournament;

	if ($c_tourn->id eq $tourn->id && $certain eq "I am certain") { 
		$event->delete;
		$m->redirect("$Tab::url_prefix/setup/events/edit.mhtml");
	} 
	
</%init>

% 	if ($c_tourn->id ne $tourn->id) { 

		<h3>Permission error:</h3>

		<p>That event does not belong to your tournament.  Try again</p>

% 	} 

	<form action="event_rm.mhtml" method="post">
	<input type="hidden" value="<% $event->id %>" name="event_id">

		<&  "/funclib/warning.mas", account => $account &>

		<center>
		<P><B>You are about to permanently delete all of <% $event->name %></b></p>

		<p>The event, judges and competitors underneath will all be toast.
		This cannot be undone.  You can only get it back by re-entering the
		whole thing over again.</p>

		<p>Don't say I didn't warn you.</p>

% 		if ($certain) {

			<p>
				<font color="red">
					You did not type "I am certain", exactly like that.  Try again
				</font>
			</p>

% 		}

		<br>
		<br>
		
			<p>To proceed, type "I am certain" in the box below:</p>

		<br>
		<br>
		
			<p align="center">
				<input type="text" name="certain" size="20">
			</p>
			
			<p align="center">
				<input  type="submit" value="Yes I am sure I know what I am doing">
			</p>
			
		</form>
