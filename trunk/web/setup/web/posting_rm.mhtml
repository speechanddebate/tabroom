<%args>
	$league
	$account
	$tourn
	$posting_id
</%args>
<%init>


	my $posting = Tab::File->retrieve($posting_id);

	my $msg;
	my $err;

	if ($posting->tournament->id == $tourn->id) { 

		my $filepath = "$Tab::file_root/files/".$league->id."/tournaments/".$tourn->id."/postings/".$posting->id;
		my $garbage = `rm -f $filepath`;

		$msg = "Posting ".$posting->label." has been deleted";

		$posting->delete();


	} else { 

		$err = "Permission denied: That posting doesn't belong to your tournament.  Stop screwing around";

	}

	$m->redirect("/setup/web/postings.mhtml?err=$err&msg=$msg");

</%init>
