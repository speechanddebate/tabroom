<%args>
	$account
	$group_id => undef
	$tourn
	$circuit
	$err => undef
	$tz
</%args>
<%init>

	my $group = Tab::JudgeGroup->retrieve($group_id) if $group_id; 
	my $switch;

	my $deadline = $group->deadline->set_time_zone($tz) if $group->deadline;

	my $strike_start = $group->strike_reg_opens->set_time_zone($tz) if $group && $group->strike_reg_opens;

	my $strike_end = $group->strike_reg_closes->set_time_zone($tz) if $group && $group->strike_reg_closes;

</%init>

    <& menubar.mas, tourn => $tourn, group_id => $group_id, page => "ratings" &>


	<div class="left huge">

		<h2>
			Judge ratings for <% $group->name %> 
		</h2>

		<table cellpadding="5" width="100%" cellspacing="1">  

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller">
					<form action="ratings_save.mhtml" method="post">
					<input type="hidden" value="<%$group_id%>" name="group_id">
					Judge deadline 
					<br />(if earlier than tournament-wide deadline)
				</th>
		
				<td class="right">
		            <& /funclib/datepicker.mas, id => "deadline" &> 
					<input type="text" name="deadline" id="deadline" size="10" value="<% ($deadline) ? Tab::pickerdate($deadline) : "" %>">
				</td>
		
				<td class="right">
                    <& /funclib/timepicker.mas, name => "deadlinetime", time => $deadline &>
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller">
					Open ratings
				</th>
		
				<td class="right">
		            <& /funclib/datepicker.mas, id => "strike_start" &> 
					<input type="text" name="strike_start" id="strike_start" size="10" value="<% ($strike_start) ? Tab::pickerdate($strike_start) : "" %>">
				</td>

				<td class="right">
                    <& /funclib/timepicker.mas, name => "strike_start_time", time => $strike_start &>
				</td>
		
			</tr>
		
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller">
					Close ratings
				</th>
		
				<td class="right">
		            <& /funclib/datepicker.mas, id => "strike_end" &> 
					<input type="text" name="strike_end" id="strike_end" size="10" value="<% ($strike_end) ? Tab::pickerdate($strike_end) : "" %>">
				</td>
		
				<td class="right">
                    <& /funclib/timepicker.mas, name => "strike_end_time", time => $strike_end &>
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Judge obligation must be met before schools rate or strike
				</td>

				<td align="center">
					<input type="checkbox" name="obligation_before_strikes" value="1" 
					<% ($group) ? ($group->obligation_before_strikes) ? "checked" : "" : "" %>>
				</td>
		
			</tr>
		
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Ask for judge paradigms during registration
				</td>
		
				<td align="center">
					<input type="checkbox" name="ask_paradigm" value="1" <% ($group) ? ($group->ask_paradigm) ? "checked" : "" : "" %>>
				</td>
		
			</tr>

			<tr>
				<td colspan="5">	
					<h4>Conflicts</h4>
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Have schools enter conflicts directly (ie, not part of MPJ):
				</td>
		
				<td align="center">
					<input type="checkbox" name="conflicts" value="1" <% ($group) ? ($group->conflicts) ? "checked" : "" : "" %>>
				</td>
			
			</tr>
		
			<tr>
				<td colspan="5">	
					<h4>Strikes</h4>
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Number of school-wide judge strikes allowed
				</td>
		
				<td align="center">
					<input type="text" name="school_strikes" size="3" value="<% ($group) ? $group->school_strikes : "" %>">
				</td>
			
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Number of individual competitor strikes allowed
				</td>
		
				<td align="center">
					<input type="text" name="comp_strikes" size="3" value="<% ($group) ? $group->comp_strikes : "" %>">
				</td>
			
			</tr>

		
			<tr>
				<td colspan="5">	
					<h4>Coach Ratings</h4>
				</td>
			</tr>


			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Ask coaches to rate their judges using the scale on registration
				</td>
		
				<td align="center">
					<input type="checkbox" name="coach_ratings" value="1" <% ($group) ? ($group->coach_ratings) ? "checked" : "" : "" %>>
				</td>
			
			</tr>

			<tr>
				<td colspan="5">	
					<h4>Community Ratings or MPJ</h4>
					<p class="explain">Note: Do not enable both MPJ & strikes.  Strikes are built into the MPJ system.</p>
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Each school rates judges using the scale
				</td>
		
				<td align="center">
					<input type="checkbox" name="school_ratings" value="1" <% ($group) ? ($group->school_ratings) ? "checked" : "" : "" %>>
				</td>
			
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Each individual entry rates judges using the scale
				</th>
		
				<td align="center">
					<input type="checkbox" name="comp_ratings" value="1" <% ($group) ? ($group->comp_ratings) ? "checked" : "" : "" %>>
				</td>
			
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<th class="smaller" colspan="2">
					Allow cumulative ratings (More 1s means fewer 2s, etc)
				</th>
		
				<td align="center">
					<input type="checkbox" name="cumulate_mjp" value="1" <% ($group) ? ($group->cumulate_mjp) ? "checked" : "" : "" %>>
				</td>
			</tr>

		</table>

		<table cellpadding="5" width="100%" cellspacing="1">

			<tr class="liblrow">

				<td class="right">
					<input class="blue" type="submit" value="    Save Group Changes   ">
					</form>
				</td>

			</tr>

		</table>

	</div>

