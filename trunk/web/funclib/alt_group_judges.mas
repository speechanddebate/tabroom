<%args>
	$group
	$school => undef
</%args>
<%init>

	if ($school) { 

		Tab::Judge->set_sql("by_alt_group_and_school", 
			"select distinct judge.* 
			from judge, setting
			where judge.id = setting.judge
			and setting.tag = \"alt_group\"
			and setting.value = ?
			and setting.type = \"judge\"
			and judge.school = ? 
			order by judge.last; ");

		return Tab::Judge->search_by_alt_group_and_school($group->id, $school->id);

	} else {
	
		Tab::Judge->set_sql("by_alt_group", 
			"select distinct judge.* 
			from judge, setting
			where judge.id = setting.judge
			and setting.tag = \"alt_group\"
			and setting.value = ?
			and setting.type = \"judge\"
			order by judge.last; ");

		return Tab::Judge->search_by_alt_group($group->id);

	}


</%init>
