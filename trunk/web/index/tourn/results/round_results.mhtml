<%args>
	$tourn
	$account => undef
	$event_id => undef
	$round_id => undef
</%args>
<%init>

	my $key = $round_id;
	return if $m->cache_self( key => $key, expires_in => '2m' );

	my $event = Tab::Event->retrieve($event_id) if $event_id;
	my $round = Tab::Round->retrieve($round_id) if $round_id;

	unless ($round) { 
		$m->print("Round does not exist");
		$m->abort;
	}

	$event = $round->event unless $event;
	$tourn = $event->tourn;

	unless ($round->post_results) { 
		$m->print("Stop messing around");
		$m->abort;
	}

</%init>

	<& menu.mas, tourn_id => $tourn->id, event_id => $event->id, round_id => $round->id &> 

	<div class="main">

		<div>
			<span class="twothirds nospace">
				<h2>
					<% $tourn->name %> 
				</h2>
			</span>

			<span class="third rightalign nospace">
				<span class="twofifth nospace">
					<h4 class="nospace">
						<% $tourn->start->year %>
					</h4>
				</span>
				<span class="half nospace">
					<h4 class="nospace">
						<% $tourn->location %>  
					</h4>
				</span>
			</span>
		</div>

        <& ../tourn_header.mas, tourn => $tourn, account => $account &>

%		if ($round) { 

% 			if ( $event->type eq "speech" ) { 
				<& results_speech.mas, round => $round &>
%			}

% 			if ( $event->type eq "wudc" ) { 
				<& results_wudc.mas, round => $round &>
%			}

% 			if ( $event->type eq "congress" ) { 
%#				<& results_congress.mas, round => $round &>
%			}
	
% 			if ( $event->type eq "debate" || $event->type eq "policy" || $event->type eq "parli" || $event->type eq "pf" || $event->type eq "ld" ) { 
				<& results_debate.mas, round => $round &>
%			}

%		}

	</div>

