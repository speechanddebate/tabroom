<%args>
	$event_id => undef
</%args>
<%init>

	my $key = $event_id;
	return if $m->cache_self( key => $key, expires_in => '2m' );

	my $event = Tab::Event->retrieve($event_id) if $event_id;  
	my $tourn = $event->tourn;

	$m->abort() unless $event->setting("live_updates");

	my $switch;

	use POSIX;

</%init>

	<& menu.mas, tourn_id => $tourn->id, event_id => $event_id, &>

	<div class="main">

		<h3><% $event->name %> entries</h3>

		<p>Student records:</p>

%			my @entries = sort {$a->school->name cmp $b->school->name} $event->entries ( unconfirmed => 0, waitlist => 0);
%			my $total = scalar @entries;
%			my $count;

			<div style="width: 20em; float: left; margin-right: 10px; margin-left: 10px;">

%			foreach my $entry (@entries) {

%				if ($count == ceil($total /2)) {
					</div>
					<div style="width: 20em; float: left;">
%				}

%				$count++;

				<a class="smallish blue block" href="entry_record.mhtml?entry_id=<% $entry->id %>&tourn_id=<% $tourn->id %>">
					<span class="quarter nowrap" style="width: 100px;">
					<% $entry->code %> 
					</span>
					<% $m->comp("/funclib/entry_students.mas", entry => $entry, name => "last") %>
				</a>

%			}

			</div>

	</div>


