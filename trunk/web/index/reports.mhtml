<%args>
	$tourn_id
	$event_id => undef
</%args>
<%init>

	my $tourn =  Tab::Tournament->retrieve($tourn_id);
	my $event =  Tab::Event->retrieve($event_id);

	my @events = $tourn->field_reports;

	my $switch;

</%init>

	<h2>Field Reports for <% $tourn->name %></h2>

%		if ($event) { 

%			my @comps = sort {$a->school->name cmp $b->school->name} $event->comps(waitlist => 0, dropped => 0);

			<h4><% $event->name %></h4>

			<table cellpadding="6" cellspacing="1" width="100%">

%				foreach my $comp (@comps) { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
			
						<td>
							<% $comp->school->name %>
						</td>

						<td>
							<% $comp->school->chapter->state %>
						</td>

						<td>
							<% $comp->team_name %>
						</td>

					</tr>

%				}

			</table>

%		}

		</table>

	</div>

	<div id="tournlist">

		<h4>Events Reported:</h4>

%		foreach my $oevent (sort {$a->name cmp $b->name} $tourn->field_reports) { 

			<a class="<% ($oevent->id == $event_id ) ? "dkblueblock" : "blueblock" %>" 
				href="/index/reports.mhtml?tourn_id=<% $tourn_id %>&event_id=<% $oevent->id %>">
				<% $oevent->name %>
			</a>

%		}

	</div>

	<div style="clear: both;" />

