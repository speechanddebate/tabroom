<%args>
	$edit_id => undef
	$account
</%args>
<%init>

	my $edit = Tab::Account->retrieve($edit_id);
	my $switch;

	unless ($edit) { 
		$m->print("No user was found with that ID");
		$m->abort();
	}

</%init>

	<& menu.mas, whoami => "accounts", account => $account, edit_id => $edit_id  &>

	<div class="main">

		<h2>Edit <% $edit->first." ".$edit->last %>'s details</h2>

		<table cellpadding="5" width="100%" border="0">

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Email & login:
				</td>

				<td align="right" colspan="3">
					<form action="account_save.mhtml" method="post"> 
					<input type="hidden" name="edit_id" value="<% $edit->id %>">
					<input type="text" name="email" value="<% $edit->email %>" size="25">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
	
				<td>
					First Name:
				</td>

				<td align="right" colspan="3">
					<input type="text" name="first" value="<% $edit->first %>" size="25">
				</td>
	
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Last Name:
				</td>

				<td align="right" colspan="3">
					<input type="text" name="last" value="<% $edit->last %>" size="25">
				</td>
	
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Street Address:
				</td>

				<td align="right" colspan="3">
					<input type="text" name="street" value="<% $edit->street %>" size="25">
				</td>
	
			</tr>
	
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					City
				</td>

				<td align="right" colspan="3">
					<input type="text" name="city" value="<% $edit->city %>" size="25">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
	
				<td>
					State/Province
				</td>	

				<td align="right" colspan="3">
					<select name="state" class="fixedmed chosen">
						<& /funclib/state_select.mas, state => $edit->state &>
					</select>
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
	
				<td>
					Country
				</td>	

				<td align="right" colspan="3">
					<select name="country" class="fixedmed chosen">
						<& /funclib/country_select.mas, country => $edit->country &>
					</select>
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					ZIP code
				</td>

				<td align="right" colspan="3">
					<input type="text" name="zip" value="<% sprintf("%05d", $edit->zip) %>" size="25">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Phone Number
				</td>

				<td align="right">
					<input type="text" name="phone" value="<% $edit->phone %>" size="10">
				</td>

			</tr>

	        <tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>> 

	            <td>
	                Cell phone provider (for texts)
	            </td>

	            <td align="right">
	                <select name="provider" class="fixedmed chosen">
						<& /funclib/cell_domains.mas, provider => $edit->provider &>
	                </select>
	            </td>
	
    	    </tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					<label for="no_email">
					No Emails*:
					</label>
				</td>

				<td colspan="3" class="rightalign">
					<input type="checkbox"  id="no_email" value="1" name="no_email" <% ($edit->no_email) ? "checked" : "" %>>
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					<label for="site_admin">
					Tabroom Site Admin (God-like powers)
					</label>
				</td>

				<td colspan="3" class="rightalign">
					<input type="checkbox"  value="1" id="site_admin" name="site_admin" <% ($edit->site_admin) ? "checked" : "" %>>
				</td>
	
			</tr>

			<tr class="liblrow">

				<td colspan="10" class="rightalign">
					<input  type="submit" value=" Save Changes "> 
					</form>
				</td>

			</tr>

		</table>

		<h4>Trigger Password Reset:</h4>

		<p>
			This function will send the user an email with a link that will permit them to change their password.
		</p>


		<table width="100%" cellpadding="5" cellspacing="1">

			<tr class="yellowrow">
				<td class="rightalign">
					<form action="/user/login/forgot.mhtml">
					<input type="hidden" name="email" value="<% $edit->email %>">
					<input  type="submit" value="Reset Password">
					</form>
				</td>
			</tr>

		</table>

	</div>

