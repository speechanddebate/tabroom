<%args>
	$diocese_id
	$circuit_id
</%args>
<%init>

	my $circuit = Tab::Circuit->retrieve($circuit_id);
	my $diocese = Tab::Region->retrieve($diocese_id);

	my $switch;

</%init>

	<& menu.mas, circuit => $circuit, whoami => "dioceses" &>

	<div class="main">

		<div class="block">

			<span class="biggerspan">
				<h2>Access to <% $diocese->name %> (<% $circuit->abbr %>)</h2>
			</span>

			<span class="medbigspan rightalign">
				<a href="dioceses.mhtml?diocese_id=<% $diocese->id %>&circuit_id=<% $circuit->id %>" class="dkgreen block centeralign">
					Return to dioceses
				</a>
			</span>

		</div>

%		foreach my $admin ($diocese->admins) { 

			<div class="smallish block <% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

				<span class="biggishspan">
					<% $admin->first." ".$admin->last %>
				</span>

				<span class="half inline ">
					<% $admin->email %>
				</span>

				<span class="smallishspan centeralign">
					<a class="dkred block" href="diocese_admin_rm.mhtml?diocese_id=<% $diocese->id %>&circuit_id=<% $circuit->id %>&admin_id=<% $admin->id %>">
						Delete
					</a>
				</span>

			</div>

%		} 

		<form action="diocese_admin_add.mhtml" method="post">

			<input type="hidden" name="diocese_id" value="<% $diocese->id %>">
			<input type="hidden" name="circuit_id" value="<% $circuit->id %>">

			<div class="smallish block <% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

				<span class="biggishspan">
					Add new (must have a tabroom account):
				</span>

				<span class="half inline">
					<input type="email" size="30" name="email" placeholder="Enter email address of account">
				</span>

				<span class="smallishspan centeralign">
					<input type="submit" value="Add" class="thin">
				</span>

			</div>

		</form>

	</div>

