<%args>
	$link_id
	$circuit
</%args>
<%init>

	my $link = Tab::Link->retrieve($link_id);

	my $switch;

</%init>

	<table cellpadding="3" width="100%">

		<tr>
			<td width="100%">
				<h2>
					<% $link->name %>'s articles:
				</h2>
			</td>

			<td>
				<form action="link_edit.mhtml" method="post">
				<input type="hidden" name="link_id" value="<% $link_id %>">
				<input type="submit" class="grey" value="  Return to Category  ">
				</form>
			</td>
		</tr>

	</table>

	<table cellpadding="3" width="100%">

		<tr class="lirdrow">
			<th>Story</th>
			<th>Posted</th>
			<th>Author</th>
			<th>Last Edit:</th>
			<th></th>
		</tr>

% 		foreach my $news (sort {$b->posted->epoch cmp $a->posted->epoch} $link->news) { 

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td width="15%">
					<% $news->title %>
				</td>

				<td>
					<% $news->posted->mdy('/') %>
				</td>

				<td>
					<% substr($news->author->first,0,1)." ".$news->author->last %>
				</td>

				<td>
					<% ($news->edited_by) ? substr($news->edited_by->first,0,1)." ".$news->edited_by->last : ""%>
				</td>

				<td class="rightalign">
					<form action="news_edit.mhtml" method="post">
					<input type="hidden" name="news_id" value="<% $news->id %>">
					<input type="submit" class="grey" value="  Edit  ">
					</form>
				</td>

			</tr>

% 		}	

	</table>

