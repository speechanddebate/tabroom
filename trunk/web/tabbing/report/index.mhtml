<%args>
	$tourn
	$account
</%args>
<%init>

	my $tourn_access = Tab::TournAdmin->search( account => $account->id, tourn => $tourn->id )->first;

	my $no_setup++ if $tourn_access && $tourn_access->no_setup;
	undef $no_setup if $account->site_admin;

	my @all_events = $tourn->events;

	my @debate;
	my @speech;
	my @congress;

	foreach my $event (@all_events) { 
		push @debate, $event if $event->type ne "speech" && $event->type ne "congress";
		push @speech, $event if $event->type eq "speech";
		push @congress, $event if $event->type eq "congress";
	}

	my $switch;

</%init>

	<& menu.mas &>

	<div class="main">

		<h2>
			Results Reports
		</h2>

		<h4>
			By Event
		</h4>

		<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %> block padmore">

			<form action="event_results.mhtml" method="post">

			<span class="sixth smallish smallish">
				Entries in Order	
			</span>

			<span class="third">
				<select name="event_id" class="fixedmed">
					<option value="all">All Events</option>
%					foreach my $event (sort {$a->name cmp $b->name} $tourn->events) { 
						<option value="<% $event->id %>">
							<% $event->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third">
				<select name="report" class="fixedtiny">
					<option value="all">All Rounds</option>
					<option value="final">Final Round</option>
					<option value="elims">All Break Rounds</option>
					<option value="prelims">Prelims</option>
					<option value="prelim_ballots">Prelim Ballots Only</option>
				</select>
			
				<span class="smallish">
					Limit <input type="number" class="smaller" name="limit" size="3" min="0" max="999">
				</span>

			</span>

			<span class="smallspan centeralign">
				<input type="submit" class="thin" value=" Go ">
				</form>
			</span>

		</div>

		<div class="block <% ($switch++ % 2) ? "oddrow" : "evenrow" %> padmore">

			<form action="awards_ceremony.mhtml" method="post">

			<span class="sixth smallish">
				Award Ceremony
			</span>

			<span class="third">
				<select name="event_id" class="fixedmed">
					<option value="all">All Events</option>
%					foreach my $event (sort {$a->name cmp $b->name} $tourn->events) { 
						<option value="<% $event->id %>">
							<% $event->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third">
			</span>

			<span class="smallspan centeralign">
				<input type="submit" class="thin" value=" Go ">
				</form>
			</span>

		</div>

		<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %> block padmore">

			<form action="event_speakers.mhtml" method="post">

			<span class="sixth smallish">
				Speaker Order
			</span>

			<span class="third">
				<select name="event_id" class="fixedmed">
					<option value="all">All Events</option>
%					foreach my $event (sort {$a->name cmp $b->name} $tourn->events) { 

%						next if $event->type eq "speech";
%						next if $event->type eq "congress";

						<option value="<% $event->id %>">
							<% $event->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third">
				<select name="type" class="fixedtiny">
					<option value="">Printout</option>
					<option value="csv">Excel</option>
				</select>

				<span class="smallish">
					Limit <input type="number" class="smaller" name="limit" size="3" min="0" max="999">
				</span>
			</span>

			<span class="smallspan centeralign">
				<input type="submit" class="thin" value=" Go ">
				</form>
			</span>

		</div>

%		if (@debate) { 

			<div class="whitenohover block <% ($switch++ % 2) ? "oddrow" : "evenrow" %> padmore">

				<form action="packet.mhtml" method="post">

				<span class="sixth smallish">
					Debate Packet
				</span>

				<span class="third">
					<select name="event_id" class="fixedmed">
%						foreach my $event (sort {$a->name cmp $b->name} @debate) { 
							<option value="<% $event->id %>">
								<% $event->name %>
							</option>
%						}
					</select>
				</span>

				<span class="third">
				</span>

				<span class="smallspan centeralign">
					<input type="submit" class="thin" value=" Go ">
					</form>
				</span>

			</div>
%		}

		<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %> block padmore">

			<form action="reading.mhtml" method="post">

			<span class="sixth smallish">
				Elim Round Reading
			</span>

			<span class="third">
				<select name="event_id" class="fixedmed">
					<option value="">All Events</option>
%					foreach my $event (sort {$a->name cmp $b->name} @all_events) { 
						<option value="<% $event->id %>">
							<% $event->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third">
			</span>

			<span class="smallspan centeralign">
				<input type="submit" class="thin" value=" Go ">
				</form>
			</span>

		</div>

%		if (@debate) { 
			<div class="whitenohover block <% ($switch++ % 2) ? "oddrow" : "evenrow" %> padmore">

				<form action="stats.mhtml" method="post">

				<span class="sixth smallish">
					Side/Stats (Debate)
				</span>

				<span class="third">
					<select name="event_id" class="fixedmed">
						<option value="all">All Events</option>
%						foreach my $event (@debate) { 
							<option value="<% $event->id %>">
								<% $event->name %>
							</option>
%						}
					</select>
				</span>

				<span class="third">
					<select name="print" class="fixedsmall">
						<option value="">View</option>
						<option value="1">Print</option>
					</select>
				</span>

				<span class="smallspan centeralign">
					<input type="submit" class="thin" value=" Go ">
					</form>
				</span>

			</div>

%		}

		<br style="clear: both;">

		<h4>
			By School
		</h4>

		<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %> block padmore">

			<form action="school.mhtml" method="post">

			<span class="sixth smallish">
				School Reports
			</span>

			<span class="third">
				<select name="school_id" class="fixedmed">
					<option value="all">All Schools</option>
%					foreach my $school (sort {$a->name cmp $b->name} $tourn->schools) { 
						<option value="<% $school->id %>">
							<% $school->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third">
			</span>

			<span class="smallspan centeralign">
				<input type="submit" class="thin" value=" Go ">
			</span>

			</form>

		</div>

%		unless ($tourn->setting('ncfl') && $no_setup) { 

		<div class="block <% ($switch++ % 2) ? "oddrow" : "evenrow" %> padmore">

			<form action="sweep_schools.mhtml" method="post">

			<span class="sixth smallish">
				Sweepstakes
			</span>

			<span class="third">
				<select name="sweep_set_id" class="fixedmed">
%					foreach my $set (sort {$a->name cmp $b->name} $tourn->sweep_sets) { 
						<option value="<% $set->id %>">
							<% $set->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third rightalign">
				<input type="submit" class="thin" name="what" value="View">
			</span>

			<span class="sixth centeralign">
				<input type="submit" class="thin" name="what" value="Print">
			</span>

			</form>

		</div>

		<br style="clear: both;">

		<h4>
			By Entry
		</h4>

		<div class="block <% ($switch++ % 2) ? "oddrow" : "evenrow" %> padmore">

			<form action="sweep_students.mhtml" method="post">

			<span class="sixth smallish">
				Sweepstakes
			</span>

			<span class="third">
				<select name="sweep_set_id" class="fixedmed">
%					foreach my $set (sort {$a->name cmp $b->name} $tourn->sweep_sets) { 
						<option value="<% $set->id %>">
							<% $set->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third rightalign">
				<input type="submit" name="what" class="thin" value="View">
			</span>

			<span class="sixth centeralign">
				<input type="submit" name="what" class="thin" value="Print">
			</span>

			</form>

		</div>

		<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %> block padmore">

			<form action="ndca/points.mhtml" method="post">

			<span class="sixth smallish">
				NDCA Points
			</span>

			<span class="third">
				<select name="event_id" class="fixedmed">
%					foreach my $event (sort {$a->name cmp $b->name} $tourn->events) { 
%						next if $event->type eq "speech";
%						next if $event->type eq "congress";
%						next if $event->type eq "wudc";
%						next if $event->type eq "roundrobin";
						<option value="<% $event->id %>">
							<% $event->name %>
						</option>
%					}
				</select>
			</span>

			<span class="third">
			</span>

			<span class="smallspan centeralign">
				<input type="submit" class="thin" value=" Go ">
			</span>

			</form>

		</div>

		<br style="clear: both;">
%		}

%		if ($tourn->setting('ncfl') && not defined $no_setup) { 

			<h4>
				By Diocese
			</h4>

			<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %> block padmore">

				<span class="sixth smallish">
					Diocesan Sweepstakes
				</span>

				<span class="sixth">
				</span>

				<span class="third rightalign">
					<form action="/tabbing/report/ncfl/show_diocesan_sweeps.mhtml" method="post">
					<input type="submit" class="thin" name="what" value="View">
					</form>
				</span>

				<span class="sixth centeralign">
					<form action="/tabbing/report/ncfl/print_diocesan_sweeps.mhtml" method="post">
					<input type="submit" class="thin" name="what" value="Print">
					</form>
				</span>

			</div>

%		}

	</div>
