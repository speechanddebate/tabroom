<%args>
	$session
	$tourn
	$timeslot_id => undef
	$check_all => undef
</%args>
<%init>

	my @timeslots = $tourn->timeslots;
	@timeslots = sort {$a->start <=> $b->start} @timeslots; 

</%init>


	<div class="right small">

		<a class="blue block" href="rank.mhtml?timeslot_id=<% $timeslot_id %>">
			Return to Ballot Entry
		</a>

		<hr>
	
% 		foreach my $ts (@timeslots) { 
			<a class="<% ($ts->done) ? "green block" : "red block" %>" href="status.mhtml?timeslot_id=<% $ts->id %>">
				Status of <% $ts->name %>
			</a>
% 		}

	</div>

	<div class="left huge">

%	if ($timeslot_id) {

%		my @unranked = Tab::Judge->search_not_ranked($timeslot_id);
%		my @unaudited = Tab::Judge->search_not_audited($timeslot_id);

		
			<h2><% scalar @unranked %> Unranked:</h2>
				
			<table cellpadding="4" width="100%" cellspacing="0">
					
%				my $switch;

% 				foreach my $unr (@unranked) { 

%					my @panels = Tab::Panel->search_judge_and_timeslot( $unr->id, $timeslot_id );
%  					my $panel = shift @panels;

%      				my $block = "white block";

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
							
						<td>
%							unless ($session->limited) {	
								<a class="<% $block %>" href="/register/judge_edit.mhtml?judge_id=<% $unr->id %>">
%							}

							<% $unr->code %>
							<% substr($unr->first,0,1) %>. <%$unr->last %>
							</a>
						</td> 
								
						<td>

%							unless ($session->limited) {	
								<a class="<% $block %>" href="/panel/panel_view.mhtml?panel_id=<% $panel->id %>">
%							}

							<% $panel->event->abbr %> <% $panel->letter %>,
							Room <% $panel->room->name  %></a>

						</td> 
								
								
						<td colspan="2">
							<a class="<% $block %>" href="/tabbing/rank.mhtml?timeslot_id=<% $timeslot_id %>&judge_id=<% $unr->id %>">
								Enter Ballot
							</a>
						</td>
								
					</tr>

% 				}

				<tr>
					<td colspan="3">
						<h4>Unaudited</h4>
					</td>
				</tr>

% 				foreach my $una (@unaudited) {

%					my @panels = Tab::Panel->search_judge_and_timeslot( $una->id, $timeslot_id );
%  					my $panel = shift @panels;

%      				my $block = "white block";

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
							
						<td>
%							unless ($session->limited) {	
								<a class="<% $block %>" href="/register/judge_edit.mhtml?judge_id=<% $una->id %>">
%							}

							<% $una->code %>
							<% substr($una->first,0,1) %>. <%$una->last %>
							</a>
						</td> 
								
						<td>

%							unless ($session->limited) {	
								<a class="<% $block %>" href="/panel/panel_view.mhtml?panel_id=<% $panel->id %>">
%							}

							<% $panel->event->abbr %> <% $panel->letter %>,
							Room <% $panel->room->name  %></a>

						</td> 
								
								
						<td>
							<a class="<% $block %>" href="/tabbing/rank.mhtml?audit=Audit&timeslot_id=<% $timeslot_id %>&judge_id=<% $una->id %>">
								Entry
							</a>
						</td>

						<td>
							<a class="<% $block %>" href="/tabbing/panel_card.mhtml?panel_id=<% $panel->id %>">
								Manual Edit
							</a>
						</td>

								
					</tr>

% 				}

			</table>
		

%	}

	</div>

	<br style="clear: both;">


