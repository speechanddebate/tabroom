<%args>
	$tourn
</%args>

%	my $switch;

%	my @events = sort {$a->name cmp $b->name} $tourn->events;

	<& "reports_menu.mas", tourn => $tourn, whoami => "multiple_totals" &>

	<div class="left huge"> 
	
		<h2>Double Entry report</h2>

		<table cellpadding="3" cellspacing="1" width="100%">

			<tr class="yellowrow">

				<th class="smaller">
					Event
				</th>

				<th class="smaller mono">
					#
				</th>

% 				foreach my $event (@events) { 
					<th class="mono smaller">
						<% $event->abbr %>		
					</th>
%				}


			</tr>

% 		foreach my $event (@events) { 

%			my ($multi_ref, $other_ref) = $m->comp("/funclib/event_multi_entry.mas", event => $event);

%			my @multis = @$multi_ref;
%			my %others = %$other_ref;

			<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>"> 
			
				<td>
					<% $event->abbr %>
				</td>

				<td class="mono centeralign rightborder">
					<% scalar @multis %>
				</td>

%				foreach my $other (@events) { 
					<td class="mono centeralign smaller <% ($other->id == $event->id) ? "red" : "" %>">
						<% $others{$other->id} %>
					</td>
%				}

			</tr>

% 		}

		</table>

	</div>



