<%args>
	$circuit
	$account
	$comp_id => undef
	$diocese_id => undef
	$event_id => undef
	$tourn
</%args>
<%init>

	my $switch;

	my $comp;
	$comp = Tab::Comp->retrieve($comp_id) if ($comp_id);

	my $diocese;
	$diocese = Tab::Region->retrieve($diocese_id) if $diocese_id;
	$diocese = $comp->school->region if $comp_id;

	my $event;
	$event = Tab::Event->retrieve($event_id) if $event_id;
	$event = $comp->event if $comp_id;

	my $tourn_id = $tourn->id;

	my @chapters = sort {$a->name cmp $b->name} $diocese->chapters($tourn) if $diocese;

</%init>

	<div class="right small">
		<a class="blue block" href="/register/diocese/entry.mhtml?diocese_id=<% $diocese->id %>&tourn_id=<% $tourn_id %>">Return to <% $diocese->name%></a>

		<br />
		
		<a href="entry_rm.mhtml?comp_id=<% $comp_id %>" class="red block">
			Drop This Competitor
		</a>

	</div>

	<div class="left huge">
	
		<h2><% $diocese->name %> Entry in <% $event->name %></h2>
	
		<table cellpadding="4" width="100%" >

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>	

				<td>
					<form action="entry_save.mas" method="post">
					<input type="hidden" name="event_id" value="<% $event->id %>">
					<input type="hidden" name="comp_id" value="<% $comp_id %>">
					<% ($event->team == 1) ? "First:" : "Student One First:" %>
				</td>
				
				<td width="40">
					<input type="text" name="student_first" size="25" value="<% ($comp) ? $comp->student->first : "" %>" >
				</td> 
				
			</tr> 
			
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>	

				<td>
					Last:
				</td>
				
				<td align="left">
					<input type="text" name="student_last" size="25" value="<% ($comp) ? $comp->student->last : "" %>" >
				</td>
				
			</tr>

% 			if ($event->team == 2) { 

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>	
				
					<td>
						Student Two First
					</td>
					
					<td>
						<input type="text" name="partner_first" size="25" value="<% ($comp) ? $comp->partner->first : "" %>" >
					</td>
					
				</tr>

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
	
					<td>
						Last:
					</td>
					
					<td>
						<input type="text" name="partner_last" size="25" value="<% ($comp) ? $comp->partner->last : "" %>" >
					</td>
					
				</tr>  
% 			}

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
				
				<td>
					School:
				</td> 
				
				<td>
					<select name="chapter_id">
% 						foreach my $chapter (@chapters) { 
							<option value="<% $chapter->id %>"  <% ($comp) ? ($comp->student->chapter->id == $chapter->id) ? "selected" : "" : "" %> >
								<% $chapter->name %>
							</option>
% 						}
					</select>
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>	
			
				<td>
					Code:
				</td>
				
				<td align="left">
					<input type="text" name="code" value="<% ($comp) ? $comp->code : "" %>">
				</td> 
			</tr>

			<tr class="liblrow">
				
				<td colspan="2" align="right">
					<input class="blue" type="submit" class="blue" value="Save Entry">
					</form>
				</td>

			</tr>

		</table>

	</div>

