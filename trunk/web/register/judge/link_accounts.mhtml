<%args>
	$group_id => undef
	$tourn
</%args>
<%init>

	my $group = Tab::JudgeGroup->retrieve($group_id); 

	my @judges = sort {$a->last cmp $b->last } Tab::Judge->search(  account => 0, judge_group => $group->id );

</%init>

	<& menu.mas, tourn => $tourn, whoami => "link", group => $group &>

	<div class="main">

		<h2>Link judges to accounts</h4>

		<& "/funclib/tablesorter.mas", table => "sortable" &>

		<form action="link_accounts_save.mhtml" method="post">
		<input type="hidden" name="group_id" value="<% $group->id %>">

		<table id="sortable">

			<thead>

			<tr class="smallish yellowrow">

				<th>
				</th>

				<th>
					Judge
				</th>

				<th>
					School
				</th>

				<th>
					Email address of account
				</th>

			</tr>
			</thead>

			<tbody>

%			my $counter++;

%			foreach my $judge (@judges) { 

				<tr>

					<td class="centeralign smallish">
						<% $counter++ %>
					</td>

					<td>
						<% $judge->first." ".$judge->last %>
					</td>

					<td>
						<% $judge->school > 0 ? $judge->school->name : "Hired" %>
					</td>

					<td>
						<input type="email" name="<% $judge->id %>" size="30">
					</td>

				</tr>

%			}
			</tbody>

			<tr class="liblrow">

				<td colspan="4" class="rightalign">
					<input type="submit" value=" Link Accounts">
				</td>
			</tr>

		</table>

		</form>
	</div>

