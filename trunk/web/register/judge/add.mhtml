<%args>
	$tourn
	$school_id => undef
	$group_id
</%args>
<%init>

	my $group = Tab::JudgeGroup->retrieve($group_id);
	my $school = Tab::School->retrieve($school_id) if $school_id;


	my $switch;

</%init>


%	if ($school) { 
		<& /register/menubar.mas, school => $school, whoami => "judges", tourn => $tourn &>
%	} else { 
		<div class="left huge">
		<& menu.mas, group => $group, whoami => "add", tourn => $tourn &>
%	}

		<h2>Add a judge in <% $group->name %></h2>

			<h4>Add by idebate account:</h4>

			<table width="100%" cellpadding="4" cellspacing="1">

				<tr class="yellowrow">
					
					<td>
						<form action="add_save.mhtml" method="post">
						<input type="hidden" name="group_id" value="<% $group->id %>">
						<input type="email" name="email" placeholder="Email address" size="25">
					</td>

%					if ($group->setting("rounds_per")) { 

						<td>
							<input type="number" name="obligation" placeholder="Rounds" size="4">
						</td>

						<td>
							<input type="number" name="hired" placeholder="Hired" size="4">
						</td>
%					}

					<td>
						<select name="school_id" style="fixedmed">

							<option value="">Hired Judge</option>

%							foreach my $school ($tourn->schools) { 
								<option value="<% $school->id %>">
									<% $school->name %>
								</option>
%							}
						</select>
					</td>

					<td>
						<input type="submit" value="Go">
						</form>
					</td>

				</tr>

			</table>

			<h4 style="margin-top: 24px;">Or, add a judge without an idebate account</h4>

			<table cellpadding="4" cellspacing="1">

				<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

					<td>
						<form action="add_save.mhtml" method="post">
						<input type="hidden" name="group_id" value="<% $group->id %>">
						First name
					</td>

					<td>
						<input type="text" name="first" placeholder="First name">
					</td>

				</tr>

				<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

					<td>
						Last name
					</td>

					<td>
						<input type="text" name="last" placeholder="Last name">
					</td>

				</tr>

				<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

					<td>
						Gender
					</td>

					<td>
						F <input type="radio" name="gender" value="F">
						M <input type="radio" name="gender" value="M">
					</td>

				</tr>

				<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

					<td>
						School:
					</td>

					<td>

						<select name="school_id" style="fixedbig">

							<option value="">Hired Judge</option>

%							foreach my $school ($tourn->schools) { 
								<option value="<% $school->id %>">
									<% $school->name %>
								</option>
%							}

						</select>

					</td>

				</tr>

%				if ($group->setting("rounds_per")) { 

					<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

						<td>
							Rounds for school:
						</td>

						<td>
							<input type="number" name="obligation" size="5">
						</td>

					</tr>

					<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

						<td>
							Rounds for hire:
						</td>

						<td>
							<input type="number" name="hired" size="5">
						</td>

					</tr>

%				}

%				if ($group->setting("coach_ratings")) { 

					<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

						<td>
							Ratings
						</td>

						<td>

%						if ($group->rating_subsets) { 

% 							foreach my $subset ($group->rating_subsets) { 

									<span class="smallspan">
										<% $subset->name %>
									</span>
						
									<select name="<% $subset->id %>_rating" class="fixedsmall">
										<option value="">Unrated</option>
	
%										foreach my $tier (sort {$a->name cmp $b->name} $group->rating_tiers(type => "coach")) { 

											<option value="<% $tier->id %>">
												<% $tier->name %> - <% substr($tier->description,0,15) %>
											</option>
%										}

									</select>
%							} 

%						}  else { 

							<select name="rating">

								<option value="">
									Unrated
								</option>

%								foreach my $tier (sort {$a->name cmp $b->name} $group->rating_tiers(type => "coach")) { 
									<option value="<% $tier->id %>">
										<% $tier->name %> - <% substr($tier->description,0,15) %>
									</option>
%								}

							</select>
		
%						}

						</td>

					</tr>

%				}

%				if ($tourn->setting("track_first_year")) {

					<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

						<td>
							First year judging?
						</td>

						<td>
							<input type="checkbox" name="first_year_out" value="1">
						</td>

 					</tr>

%				}


				<tr class="liblrow">

					<td colspan="2" class="rightalign">
						<input type="submit" value="Save and Add Another" style="width: 200px;">
					</td>

				</tr>

			</table>

	</div>

	<& /register/school/judge_menu.mas, school => $school, tourn => $tourn &>
