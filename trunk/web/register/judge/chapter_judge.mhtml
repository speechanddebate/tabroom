<%args>
	$circuit
	$account
	$uber_id => undef
	$judge_id => undef
</%args>
<%init>

	my $now = DateTime->now;

	my $uber = Tab::Uber->retrieve($uber_id) if $uber_id;

	if ($judge_id && not defined $uber) { 

		my $judge = Tab::Judge->retrieve($judge_id);

		$uber = $judge->uber if $judge->uber;

		my $chapter_id = $judge->school->chapter->id if $judge->school && $judge->school->chapter;

		unless ($uber) { 

			$uber = Tab::Uber->create({
				chapter => $chapter_id,
				first => $judge->first,
				last => $judge->last, 
				gender => $judge->gender,
				created => $now,
				cell => $judge->cell,
				paradigm => $judge->paradigm
			});

			$judge->uber($uber->id);
			$judge->update;

		}

		$uber_id = $uber->id;

	}

</%init>

	<div class="main">

		<h2>Edit <%$uber->first." ".$uber->last %></h2>

%		my $switch;

		<table cellpadding="5" cellspacing="1" width="100%" >

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					First Name:
				</td>

				<td>
					<form action="uber_save.mhtml" method="post">
					<input type="hidden" name="uber_id" value="<% $uber_id %>">
					<input type="hidden" name="judge_id" value="<% $judge_id %>">
					<input type="text" name="first" size="30" value="<% ($uber) ? $uber->first : "" %>">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
	
				<td>
					Last Name:
				</td>

				<td>
					<input type="text" name="last" size="30" value="<% ($uber) ? $uber->last : ""%>">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Cell Phone #:
				</td>

				<td>
					<input type="text" name="cell" size="15" value="<% ($uber) ? $uber->cell : ""%>">
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Started Judging in (year):
				</td>

				<td>
					<input type="text" name="started" size="6" value="<% ($uber) ?   $uber->started : ""%>">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Gender:
				</td>

				<td>
					<input type="radio" id="M" name="gender" value="M" <% ($uber) ? ($uber->gender eq "M") ? "checked" : "" : "" %>> 
						<label for="M">Male</label>

					<input type="radio" id="F"name="gender" value="F" <% ($uber) ? ($uber->gender eq "F" ) ? "checked" : "" : "" %>> 
						<label for="F">Female</label>
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Notes:
				</td>

				<td>
					<input type="text" size="30" name="notes" value="<% ($uber) ? $uber->notes : "" %>">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td colspan="2">
					Debate Judge Paradigm (link or text):
				</td>

			</tr>

			<tr>
				<td colspan="2" align="center">
					<textarea name="paradigm" rows="5" cols="55"><% ($uber) ? $uber->paradigm : "" %></textarea>
				</td>
			</tr>

			<tr class="liblrow">
				<td align="right" colspan="2">
					<input  type="submit" value="  Save Judge Details ">
				</td>
			</tr>

		</table>

	</div>

	<div class="menu">

%		if ($uber) {

			<h4>
				Judge History:
			</h4>
	
%			foreach my $judge ($uber->judges) { 
				<a class="blue block" href="judge_edit.mhtml?judge_id=<% $judge->id %>">
					<% $judge->code %>
					<% $judge->judge_group->abbr %> at <% $judge->judge_group->tournament->name %>
				</a>
%			}	

			<hr>
%		}

%		if ($account->site_admin) { 

			<% $uber->id %> is uber id

%		}

	</div>
