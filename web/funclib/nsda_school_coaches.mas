<%args>
	$nsda    => undef
	$school  => undef
	$chapter => undef
</%args>
<%init>

	use Tab::NSDA::Person;

	Tab::NSDA::Person->set_sql(coaches => "
		select NEW_USERS.*
			from NEW_USERS, NEW_USERS_TO_SCHOOLS
			where NEW_USERS_TO_SCHOOLS.school_id = ?
			and NEW_USERS_TO_SCHOOLS.enddate='0000-00-00 00:00:00'
			and NEW_USERS_TO_SCHOOLS.ualt_id = NEW_USERS.ualt_id
			and NEW_USERS.utype = 'Coach'
	");

	return unless ($school || $chapter || $nsda);

	unless ($nsda) {
		$chapter = $school->chapter unless $chapter;
		$nsda = $chapter->nsda;
	}

	return unless $nsda > 0;

	return Tab::NSDA::Person->search_coaches($nsda);

</%init>
