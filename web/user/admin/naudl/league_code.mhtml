<%args>
	$person
    $tourn
    $circuit_id     => undef
	$property_value => undef
</%args>
<%init>


	$m->clear_buffer();
	$r->content_type('application/json');

    my $circuit = Tab::Circuit->retrieve($circuit_id);
	$circuit->setting("naudl_league_code", $property_value);

	my $message = "Circuit ".$circuit->name." league code was changed to $property_value";

	$m->comp("/funclib/log.mas",
		type        => 'naudl',
		circuit     => $circuit->id,
		person      => $person->id,
		description => $message
	);

    my %response = (
		error   => 0,
		message => $message,
    );

    $m->print(JSON::encode_json(\%response));
	$m->abort();

</%init>
