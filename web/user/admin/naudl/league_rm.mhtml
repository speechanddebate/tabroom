<%args>
	$person
    $tourn
    $circuit_id => undef
</%args>
<%init>


	$m->clear_buffer();
	$r->content_type('application/json');

    my $circuit = Tab::Circuit->retrieve($circuit_id);

	$circuit->setting("naudl_league_code", 0);
	$circuit->setting("naudl_member", 0);

	my $message = "Circuit ".$circuit->name." was removed from the NAUDL Network";

	$m->comp("/funclib/log.mas",
		type        => 'naudl',
		circuit     => $circuit->id,
		person      => $person->id,
		description => $message
	);

    my %response = (
		error   => 0,
		message => $message,
		destroy => $circuit->id
    );

    $m->print(JSON::encode_json(\%response));
	$m->abort();

</%init>
