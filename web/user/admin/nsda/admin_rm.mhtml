<%args>
	$person
	$perms
	$district_id
	$admin_id
	$dbh
</%args>
<%init>

	$m->clear_buffer();
	$r->content_type('application/json');

	if ($person->site_admin || $perms->{district}{$district_id} eq "chair") {

		my $sth = $dbh->prepare("
			delete permission.*
			from permission
			where permission.person = ?
			and permission.district = ?
		");

		$sth->execute($admin_id, $district_id);

		my %response = (
			error => \0,
			message => "Access removed"
		);

		$m->print(JSON::encode_json(\%response));
		$m->abort();
	}

	my %response = {
		error => \1,
		message => "You do not have permission to remove that access."
	};

</%init>

