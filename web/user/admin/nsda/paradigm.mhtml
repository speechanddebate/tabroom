<%args>
	$person
	$person_settings
</%args>
<%init>

	$m->abort unless $person->site_admin;

	my @tags = (
		"paradigm_guidelines",
		"paradigm_review_start",
		"paradigm_word_limit",
		"paradigm_word_limit_deadline",
		"paradigm_word_limit_guidelines",
		"paradigm_button_name",
		"paradigm_button_url",
		"paradigm_main_text",
		"paradigm_judge_text",
		"paradigm_review_cutoff"
	);

	my %settings;

	foreach my $tag (@tags) {
		$settings{$tag} = Tab::TabroomSetting->search(
			tag   => $tag
		)->first;
	}

	my $start;

	if ($settings{paradigm_review_start}) {
		$start = $settings{paradigm_review_start}->value_date;
	}

	my $cutoff;

	if ($settings{paradigm_review_cutoff}) {
		$cutoff = $settings{paradigm_review_cutoff}->value_date;
	}

</%init>

	<& ../menu.mas,
		whoami          => "paradigms",
		person          => $person,
		person_settings => $person_settings
	&>

	<& "/funclib/editor.mas", height => "256" &>

	<div class="main">

		<div class="flexrow">
			<span class="fourfifths">
				<h4>Paradigm Guidelines</h4>
			</span>

			<span class="fifth rightalign padright">
				<a
					class = "buttonwhite bluetext invert padright padleft"
					href  = "paradigm_log.mhtml"
				>Paradigm Log</a>
			</span>
		</div>

		<form
			action = "paradigm_save.mhtml"
			method = "post"
		>

		<div class="row flexrow">
			<span class="quarter marno padleft">
				Paradigm Button Text
			</span>

			<span class="quarter padvert padright">
				<input
					type  = "text"
					class = "notfirst"
					name  = "paradigm_button_name"
					id    = "paradigm_button_name"
					value = "<% $settings{paradigm_button_name} ? $settings{paradigm_button_name}->value : "" %>"
				>
			</span>

			<span class="quarter marno padleft">
				Paradigm Button URL
			</span>

			<span class="quarter padvert padright">
				<input
					type  = "url"
					class = "notfirst"
					name  = "paradigm_button_url"
					id    = "paradigm_button_url"
					value = "<% $settings{paradigm_button_url} ? $settings{paradigm_button_url}->value : "" %>"
				>
			</span>
		</div>

		<& "/funclib/editor.mas", id => "paradigm_guidelines" &>

		<div class="row flexrow">
			<span class="third marno padleft">
				Unpublish Paradigms On
			</span>

			<span class="sixth padvert">
				<input
					type  = "date"
					class = "notfirst"
					name  = "paradigm_review_cutoff"
					id    = "paradigm_review_cutoff"
					value = "<% $cutoff ? $cutoff->ymd : "" %>"
				>
			</span>

			<span class="third marno padleft">
				Unless they've been reviewed after
			</span>

			<span class="sixth padright padvertless">
				<input
					type  = "date"
					class = "notfirst"
					name  = "paradigm_review_start"
					id    = "paradigm_review_start"
					value = "<% $start ? $start->ymd : "" %>"
				>
			</span>
		</div>

		<div class='row centeralign'>
			<h5 class="leftalign padleft">
				Text on Front Search Pages
			</h5>
			<span class="ninetenths">
				<textarea
					name = "paradigm_main_text"
					id   = "paradigm_main_text"
				><% $settings{paradigm_main_text} ? $settings{paradigm_main_text}->value_text : "" %></textarea>
			</span>
		</div>

		<div class='row centeralign'>
			<h5 class="leftalign padleft">
				Text on Judge Search Pages
			</h5>
			<span class="ninetenths">
				<textarea
					name = "paradigm_judge_text"
					id   = "paradigm_judge_text"
				><% $settings{paradigm_judge_text} ? $settings{paradigm_judge_text}->value_text : "" %></textarea>
			</span>
		</div>

		<div class="row centeralign">
			<h5 class="leftalign padleft">
				Guidelines for Paradigm Edit Page
			</h5>
			<span class="ninetenths">
				<textarea
					name = "paradigm_guidelines"
					id   = "paradigm_guidelines"
				><% $settings{paradigm_guidelines} ? $settings{paradigm_guidelines}->value_text : "" %></textarea>
			</span>
		</div>

		<div class="row flexrow">
			<span class="third marno padleft">
				Word Limit
			</span>

			<span class="sixth padright">
				<input
					type  = "number"
					class = "notfirst sizeme"
					name  = "paradigm_word_limit"
					id    = "paradigm_word_limit"
					value = "<% $settings{word_limit} ? $settings{word_limit}->value : "" %>"
				>
			</span>

			<span class="third marno padleft">
				Word Limit Deadline
			</span>

			<span class="sixth padright">
				<input
					type  = "date"
					class = "notfirst"
					name  = "paradigm_word_limit_deadline"
					id    = "paradigm_word_limit_deadline"
					value = "<% $settings{word_limit_deadline} ? $settings{word_limit_deadline}->value_date->ymd : "" %>"
				>
			</span>
		</div>

		<div class="row centeralign">
			<h5 class="leftalign padleft">
				Word Limit Guidelines
			</h5>
			<span class="ninetenths">
				<textarea
					name = "paradigm_word_limit_guidelines"
					id   = "paradigm_word_limit_guidelines"
				><% $settings{word_limit_guidelines} ? $settings{word_limit_guidelines}->value_text : "" %></textarea>
			</span>
		</div>

		<div class="liblrow rightalign">
			<span class="half centeralign">
				<input
					type  = "submit"
					class = "padvert"
					value = "Save Paradigm Settings"
				>
			</span>
		</div>

		</form>
	</div>

