<%args>
	$account
	$school_id
	$tourn_id => undef
</%args>
<%init>

	my $school = Tab::School->retrieve($school_id);

	my $tourn = $school->tournament;
	my $region = $school->region;

	unless ($region->director->id == $account->id) { 
		$m->print("Stop messing around.  You are not authorized to view that region");
		$m->abort;
	}

	my $switch;

	my @comps = sort {$a->code <=> $b->code} $school->comps;
	@comps = sort {$a->event->abbr cmp $b->event->abbr} @comps;

</%init>

	<h2><% $tourn->name %></h2>

	<div class="left huge"> 

		<h3><% $school->name %></h3>

		<table cellpadding="5" cellspacing="1" width="100%">

			<tr class="lirdrow">

				<th>
					Event
				</th>

				<th>
					Code
				</th>

				<th>
					Name
				</th>

				<th colspan="2">
					Qualifier(s)
				</th>

			</tr>

%			foreach my $comp (@comps) { 

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

					<td>
						<% $comp->event->abbr %>
					</td>

					<td>
						<% $comp->code %>
					</td>

					<td class="smaller">
						<% $comp->team_name %>
					</td>

					<td class="smaller">
						<% $comp->qualifier %> <% $comp->qualexp %>
					</td>

					<td class="smaller">
						<% $comp->qual2 %> <% $comp->qual2exp %>
					</td>

				</tr>
%			}

		</table>

	</div>

	<div id="rightsmall">

		<a class="red block" href="region.mhtml?region_id=<% $region->id %>&tourn_id=<% $tourn->id %>">
			Return to Region List
		</a>

		<h3>Other Schools</h3>

%		foreach my $school ($tourn->schools(region => $region->id)) {

			<a class="<% ($school->id == $school_id) ? "chosenblock" : "blue block" %>" href="school_entry.mhtml?school_id=<% $school->id %>">
				<% $school->name %> 
			</a>

%		}

	</div>
