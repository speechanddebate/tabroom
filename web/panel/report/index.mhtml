<%args>
	$tourn
	$person
	$person_settings
	$perms
</%args>
<%init>

	my ($eventref, $catref) = $m->comp(
		"/funclib/allowed_events.mas", 
		tourn => $tourn,
		perms => $perms,
		type  => "admin"
	);

	my @events = @{$eventref};
	my @categories = @{$catref};

	my @seed_events;

	foreach my $event (@events) { 
		push @seed_events, $event if (
			$event->setting("apda") 
			|| $event->setting('seed_presets')
		);
	}

	my @timeslots = $tourn->timeslots;
	@events = sort { $a->name cmp $b->name } @events;
	@timeslots = sort { $a->start cmp $b->start } @timeslots;

	my @sites = $tourn->sites; 

</%init>

	<& menu.mas, 
		tourn  => $tourn,
		whoami => "events"
	&>

	<div class="main">

		<span class="half">
			<h2>Printouts</h2> 
		</span>
		<span class="quarter bluetext semibold rightalign">
			Change Font Sizes: 
		</span>
		<span class="quarter rightalign">
			<& "/funclib/fonts.mas", default => $person_settings->{"fontsize"} &> 
		</span>

		<table>

			<tr class="row">

				<td class="smallish">
					<form action="schematic.mhtml" method="post">
					Schematics
				</td>

				<td class="smallish">
					<select name="timeslot_id" class="fixedsmall"> 
						<option value="all">
							All Timeslots
						</option> 

% 						foreach my $timeslot (@timeslots) { 
							<option value="<% $timeslot->id %>"> <% $timeslot->name %> </option> 
% 						}
						
					</select>
				</td> 
				
				<td>

%					if (scalar @sites > 1) { 

						<select name="event_id" class="fixedmed" >
							<option value="all">All Events</option> 
%	 						foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									<% scalar @events == 1 ? 'selected' : "" %> 
										value="<% $event->id %>"><% $event->name %></option> 
% 							}
						</select>

						<select name="site_id" class="fixedmed" > 

							<option value="all">All Sites</option> 

% 							foreach my $site (@sites) { 
								<option value="<% $site->id %>"><% $site->name %></option> 
%	 						}

						</select>

%					} else { 
						<select name="event_id" class="fixedmed" >
							<option value="all">All Events</option> 
% 							foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									value="<% $event->id %>"><% $event->name %></option> 
% 							}
						</select>
% 					}
					
				</td> 
				
				<td class="smaller nospace">

					<label for="schools">
						<div class="hover full marno padless">
							<span class="threequarters nospace padleft">
								For Tab (full info)
							</span>
							<span class="quarter nospace centeralign">
								<input 
									type  = "checkbox"
									class = "nospace"
									id    = "schools"
									name  = "schools"
									value = "hewwo"
								>
							</span>
						</div>
					</label>

					<label for="no_break" >
						<div class="hover full padless marno">
							<span class="threequarters nospace padleft">
								No Pagebreaks
							</span>
							<span class="quarter nospace centeralign">
								<input 
									type  = "checkbox"
									class = "nospace"
									id    = "no_break"
									name  = "no_break"
									value = "hewwo"
								>
							</span>
						</div>
					</label>

					<label for="event_break" >
						<div class="hover full padless marno">
							<span class="threequarters nospace padleft">
								Break between events
							</span>
							<span class="quarter nospace centeralign">
								<input 
									type  = "checkbox"
									class = "nospace"
									id    = "event_break"
									name  = "event_break"
									value = "hewwo"
								>
							</span>
						</div>
					</label>
				</td>
				
				<td class="centeralign">
					<input  
						type  = "submit"
						class = "thin"
						value = "Print"
					>
					</form>
				</td>
				
			</tr>

			<tr class="row">
			
				<td class="smallish">
					<form 
						action = "postings.mhtml"
						method = "post"
					>
					Postings
				</td>
				
				<td class="smallish">
					<select name="timeslot_id" class="fixedsmall"> 

						<option value="all">All Timeslots</option> 

% 						foreach my $timeslot (@timeslots) { 
							<option value="<% $timeslot->id %>"><% $timeslot->name %></option> 
% 						}

					</select> 
					
				</td>
				
				<td>
				
					<select name="event_id" class="fixedmed" > 
					
						<option value="all">All Events</option> 

% 						foreach my $event (@events) { 
							<option <% scalar @events == 1 ? 'selected' : "" %> 
								value="<% $event->id %>"><% $event->name %></option> 
% 						}

					</select>

				</td>

				<td>
				</td>
				
				<td class="centeralign">
					<input  
						type  = "submit"
						class = "thin"
						value = "Print"
					>
					</form>
				</td>
				
			</tr>

			<tr class="row">
			
				<td class="smallish">
					<form 
						action = "slideshow.mhtml"
						method = "post"
					>
					Slideshow 
				</td>
				
				<td class="smallish">
					<select name="timeslot_id" class="fixedsmall"> 
% 						foreach my $timeslot (@timeslots) { 
							<option value="<% $timeslot->id %>"><% $timeslot->name %></option> 
% 						}
					</select> 
					
				</td>
				
				<td>
				
					<select name="event_id" class="fixedmed" > 
						<option value="all">All Events</option>
% 						foreach my $event (@events) { 
							<option <% scalar @events == 1 ? 'selected' : "" %> 
								value="<% $event->id %>"><% $event->name %></option> 
% 						}
					</select>
					
				</td>

				<td>
				</td>
				
				<td class="centeralign">
					<input  type="submit" class="thin" value="Show"> 
					</form>
				</td>
				
			</tr>

			<tr class="row">
			
				<td class="smallish">
					<form action="strike_cards.mhtml" method="post">
					Strike Cards
				</td>
				
				<td class="smallish">
					<select name="timeslot_id" class="fixedsmall"> 
% 						foreach my $timeslot (@timeslots) { 
							<option value="<% $timeslot->id %>"><% $timeslot->name %></option> 
%						}
					</select>
				</td>
				
				<td>
					<select name="event_id" class="fixedmed" > 
% 						foreach my $event (@events) { 
							<option <% scalar @events == 1 ? 'selected' : "" %> 
								value="<% $event->id %>"><% $event->name %></option> 
% 						}
					</select>
				</td>

				<td class="smallish centeralign">
					Strikes: <input 
						type  = "number"
						name  = "number"
						min   = "0"
						max   = "99"
						class = "smaller"
					>
				</td>
				
				<td class="centeralign">
					<input
						type  = "submit"
						class = "thin"
						value = "Show"
					>
					</form>
				</td>
				
			</tr>

%			if (@seed_events) { 

				<tr class="row">
				
					<td class="smallish">
						<form action="preset_draw.mhtml" method="post">
						Preset Seed Draw
					</td>
					
					<td>
					</td>

					<td>
						<select name="event_id" class="fixedmed" > 
%	 						foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									value="<% $event->id %>"><% $event->name %></option> 
%	 						}
						</select>
					</td>

					<td class="smallish centeralign">
					</td>
					
					<td class="centeralign">
						<input  type="submit" class="thin" value="Show"> 
						</form>
					</td>
					
				</tr>

%			}

			<tr>
				<td>
					&nbsp;
				</td>
			</tr>

			<tr class="row">

				<td class="smallish">
					<form action="judge_chart.mhtml" method="post">
					Judge Chart
				</th>

				<td class="smallish">
					<select name="sort_by" class="fixedsmall">
						<option value="code">by Judge Code</option>
						<option value="last">by Last Name</option>
					</select>
				</td>
		
				<td>
					<select name="category_id" class="fixedmed">

% 					foreach my $category (@categories) {
%						next if $category && $category->id != $category->id;
						<option value="<% $category->id %>"> <% $category->name %> </option>
%					}

						<option value="">----------</option>

					</select>
				</td>

				<td>
				</td>

				<td class="centeralign">
					<input  type="submit" class="thin" value="Print">
					</form>
				</td>

			</tr>

			<tr class="row">

				<td class="smallish">
					Ballot Checkin
					<form action="ballot_table.mhtml" method="post">
				</td>
		
				<td class="smallish">
					<select name="timeslot_id" class="fixedsmall"> 
% 					foreach my $timeslot (@timeslots) { 
						<option value="<% $timeslot->id %>"><% $timeslot->name %></option> 
% 					}
					</select>
				</td>
		
				<td>
					<select name="event_id" class="fixedmed">

						<option value="">All Events</option>

%						foreach my $event (@events) { 
							<option <% scalar @events == 1 ? 'selected' : "" %> 
								value="<% $event->id %>"
							> <% $event->name %> </option>

%						}

					</select>
				</td> 

				<td class="smallish">
					<select name="sort_by" class="fixedsmall">
						<option value="jcode">By Code</option>
						<option value="jname">By Name</option>
						<option value="room">By Room</option>
						<option value="event">By Event</option>
					</select>
				</td>
				
				<td class="centeralign">
					<input  type="submit" class="thin" value="Print"> 
					</form>
				</td> 
				
			</tr> 

			<tr class="row">
				
				<td class="smallish">
					Master Ballots
					<form action="master_ballots.mhtml" method="post">
				</td>
				
				<td class="smallish">
					<select name="timeslot_id" class="fixedsmall"> 
						<option value="all">All Timeslots</option> 

% 						foreach my $timeslot (@timeslots) { 
							<option value="<% $timeslot->id %>"
								><% $timeslot->name %></option> 
% 						}
					</select> 
				</td>
				
				<td>
%					if (scalar @sites > 1) { 

						<select name="event_id" class="fixedsmall" >
							<option value="all">All Events</option> 
%	 						foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									value="<% $event->id %>"
								><% $event->name %></option> 
% 							}
						</select>

						<select name="site_id" class="fixedsmall" > 

							<option value="all">All Sites</option> 

% 							foreach my $site (@sites) { 
								<option value="<% $site->id %>"><% $site->name %></option> 
%	 						}

						</select>

%					} else { 

						<select name="event_id" class="fixedmed" >
							<option value="all">All Events</option> 
% 							foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									value="<% $event->id %>"><% $event->name %></option> 
% 							}
						</select>

% 					}
					
				</td>
				
				<td class="smallish">

					<select name="sort_by" class="fixedsmall">
						<option value = "">By Event</option>
						<option value = "code">By Judge Code</option>
						<option value = "school">By Judge School</option>
						<option value = "name">By Judge Name</option>
						<option value = "blank">Blank</option>
						<option value = "panname">by Event then Judge Name</option>
					</select>

				</td> 
				
				<td class="centeralign">
					<input 
						type  = "submit"
						class = "thin"
						value = "Print"
					>
					</form>
				</td>
					
			</tr>

			<tr class="row">
				
				<td class="smallish">
					Unlinked Masters
					<form 
						action="master_ballots.mhtml" 
						method="post"
					>
					<input 
						type  = "hidden"
						name  = "personless"
						value = "1"
					>
				</td>
				
				<td class="smallish">
					<select name="timeslot_id" class="fixedsmall"> 
						<option value="all">All Timeslots</option> 

% 						foreach my $timeslot (@timeslots) { 
							<option value="<% $timeslot->id %>"
								><% $timeslot->name %></option> 
% 						}
					</select> 
				</td>
				
				<td>
%					if (scalar @sites > 1) { 

						<select name="event_id" class="fixedsmall" >
							<option value="all">All Events</option> 
%	 						foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									value="<% $event->id %>"
									><% $event->name %></option> 
% 							}
						</select>

						<select name="site_id" class="fixedsmall" > 

							<option value="all">All Sites</option> 

% 							foreach my $site (@sites) { 
								<option value="<% $site->id %>"><% $site->name %></option> 
%	 						}

						</select>

%					} else { 

						<select name="event_id" class="fixedmed" >
							<option value="all">All Events</option> 
% 							foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									value="<% $event->id %>"><% $event->name %></option> 
% 							}
						</select>

% 					}
					
				</td>
				
				<td class="smallish">

					<select name="sort_by" class="fixedsmall">
						<option value = "">By Event</option>
						<option value = "code">By Judge Code</option>
						<option value = "school">By Judge School</option>
						<option value = "name">By Judge Name</option>
						<option value = "blank">Blank</option>
						<option value = "panname">by Event then Judge Name</option>
					</select>

				</td> 
				
				<td class="centeralign">
					<input 
						type  = "submit"
						class = "thin"
						value = "Print"
					>
					</form>
				</td>
					
			</tr>

			<tr class="row">
		
				<td class="smallish">
					Ballot Labels
					<form action="ballot_labels.mhtml" method="post">
				</td> 
					
				<td class="smallish">

					<select name="timeslot_id" class="fixedsmall"> 
						<option value="all">All Timeslots</option> 
% 						foreach my $timeslot (@timeslots) { 
							<option value="<% $timeslot->id %>"><% $timeslot->name %></option> 
% 						}
					</select>

				</td> 
				
				<td class="nospace">

					<span class="twofifths rightalign ">

						<select name="event_id" class="fixedmicro"> 

							<option value="all">All</option> 

% 							foreach my $event (@events) { 
								<option <% scalar @events == 1 ? 'selected' : "" %> 
									value="<% $event->id %>"><% $event->abbr %></option> 
% 							}

						</select>

					</span>

					<span class="threefifths">
						<select name="sort_by" class="fixedsmaller">
							<option value="event">by Event</option>
							<option value="rooms">By Room</option>
							<option value="names">By Judge</option>
							<option value="codes">By Judge Code</option>
						</select>
					</span>
				</td> 
					
				<td class="smaller centeralign">

					<a 
						class="greytext buttonwhite smaller"
						href="adjust_labels.mhtml"
					>Adjust Labels</a>

					<br />

					<a 
						class="greytext buttonwhite smaller"
						href  = "pick_labels.mhtml"
					>Choose Events</a>

				</td>
					
				<td class="centeralign">
					<input  type="submit" class="thin" value="Print"> 
					</form>
				</td>
			</tr>

		</table>

	</div>
