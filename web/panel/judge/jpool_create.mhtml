<%args>
	$tourn
	$name             => undef
	$publish          => undef
	$show_judges      => undef
	$category_id      => undef
	$standby          => undef
	$code             => undef
	$parent           => undef
	$rounds           => undef
	$standby_timeslot => undef
	$site             => undef
</%args>
<%init>

	my $msg;

	if ($name) {

		unless ($site) {
			my @sites = $tourn->sites;
			$site = shift @sites if @sites;
		}

		if ($site) {

			my $jpool = Tab::JPool->create({
				name     => $name,
				site     => $site,
				parent   => $parent,
				category => $category_id,
			});

			$jpool->setting('show_judges', $show_judges);
			$jpool->setting('publish', $publish);
			$jpool->setting('standby', $standby);
			$jpool->setting('code', $code);
			$jpool->setting('rounds', $rounds);
			$jpool->setting('standby_timeslot', $standby_timeslot);

		}

		$msg = "Pool $name created";
	}

	$m->redirect("edit_jpools.mhtml?category_id=$category_id&msg=$msg");

</%init>
