<%args>
	$round_id => undef
	$post     => undef
</%args>
<%init>

	$m->clear_buffer();
	$r->content_type('application/json');

	my $msg = "Round not sent.  Hit refresh and try again";
	$m->print('{ "error":true,"message":"'.$msg.'" }') unless $round_id;

	my $round = Tab::Round->retrieve($round_id) if $round_id;
	$m->abort unless $round;

	$post = 2 if $post > 2;

	$round->post_results($post);
	$round->update;

	$msg = "Speaker points and results are posted" if $post == 2;
	$msg = "Results without speaker points are posted" if $post == 1;
	$msg = "No results are posted" unless $post;


	$m->print('{ "error":false,"message":"'.$msg.'" }');
	$m->abort();

</%init>
