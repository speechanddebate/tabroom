<%args>
	$session
	$tourn
	$timeslot_id => undef
	$check_all => undef
</%args>
<%init>

	my @timeslots = $tourn->timeslots;
	@timeslots = sort {$a->start <=> $b->start} @timeslots; 

	my $timeslot = Tab::Timeslot->retrieve($timeslot_id) if $timeslot_id;

	my @panels = $m->comp('/funclib/timeslot_panels.mas', timeslot => $timeslot) if $timeslot;
	my %panels_by_id =();
	foreach my $panel (@panels) { 
		$panels_by_id{$panel->id} = $panel;
	}

</%init>

	<div class="right small">
	
		<div class="sidenote">

			<a class="blue block" href="rank.mhtml?timeslot_id=<% $timeslot_id %>">
				Return to Ballot Entry
			</a>

			<hr>
		
% 			foreach my $ts (@timeslots) { 
%				my @unranked = $m->comp('/funclib/timeslot_judges.mas', timeslot => $ts, status => "full");
%				my @unaudited = $m->comp('/funclib/timeslot_judges.mas', timeslot => $ts, status => "half");

%				my $class = "green";
%				$class = "yellow" if @unaudited;
%				$class = "red" if @unranked;

				<a class="<% $ts->id == $timeslot_id ? "dk" : "" %><% $class %> block " href="status.mhtml?timeslot_id=<% $ts->id %>">
					<% $ts->name %>
				</a>
% 			}

		</div>

	</div>

	<div class="left huge">

%	if ($timeslot_id) {

%		my @unranked = $m->comp('/funclib/timeslot_judges.mas', timeslot => $timeslot, status => "full");
%		my @unaudited = $m->comp('/funclib/timeslot_judges.mas', timeslot => $timeslot, status => "half");

		<div class="left half">

			<h4><% scalar @unranked %> Unranked:</h4>

% 				foreach my $judge (@unranked) { 
					<a class="noline red block smallish nowrap" href="/tabbing/entry/index.mhtml?timeslot_id=<% $timeslot_id %>&judge_id=<% $judge->id %>">
						<span class="evensmallerspan padno inline">
							<% $panels_by_id{$judge->panelid} ? $panels_by_id{$judge->panelid}->round->event->abbr : "" %>
						</span>
						<span class="smallspan padno inline ">
							<% $judge->school && $judge->school->code ? $judge->school->code : "XX" %> <% $judge->code %>
						</span>
						<span class="editspan padno inline " style="margin-left: 6px;">
							<% $judge->first." ".$judge->last %>
						</span>
						<span class="schemat padno inline  nowrap" style="margin-left: 6px; width: 80px;">
							<% $panels_by_id{$judge->panelid} ?  $panels_by_id{$judge->panelid}->room->name : "" %>
						</span>
					</a>


%				}

		</div>


		<div class="right half">

			<h4><% scalar @unaudited %> Unaudited:</h4>

% 				foreach my $judge (@unaudited) { 
					<a class="noline yellow block smallish nowrap" href="/tabbing/entry/index.mhtml?timeslot_id=<% $timeslot_id %>&judge_id=<% $judge->id %>">
						<span class="evensmallerspan padno inline">
							<% $panels_by_id{$judge->panelid} ? $panels_by_id{$judge->panelid}->round->event->abbr : "" %>
						</span>
						<span class="smallspan padno inline ">
							<% $judge->school && $judge->school->code ? $judge->school->code : "XX" %> <% $judge->code %>
						</span>
						<span class="editspan padno inline " style="margin-left: 6px;">
							<% $judge->first." ".$judge->last %>
						</span>
						<span class="schemat padno inline  nowrap" style="margin-left: 6px; width: 80px;">
							<% $panels_by_id{$judge->panelid} ?  $panels_by_id{$judge->panelid}->room->name : "" %>
						</span>
					</a>

%				}

		</div>

%	} 

	</div>

