<%args>

</%args>
<%init>

	my $dbh = Tab::DBI->db_Main();

	my $tourn_id    = 35467;

	my $sth = $dbh->prepare('
		select
			judge.id
		from (judge, person, category)
		where person.email = ?
			and person.id = judge.person
			and judge.category = category.id
			and category.tourn = ?
	');

	#my $early_shift = Tab::JudgeShift->retrieve(48247);
	my $early_shift = Tab::JudgeShift->retrieve(48251);

	my @early_emails = (
		'email@sample.org',
	);

	foreach my $email (@late_emails) {

		$sth->execute($email, $tourn_id);
		my $judge = $sth->fetch_hash();

		if ($judge && $judge->{id} > 0) {
			Tab::Strike->create({
				tourn => $tourn_id,
				shift => $late_shift->id,
				type  => "time",
				judge => $judge->{id},
				start => $late_shift->start,
				end   => $late_shift->end
			});
		}
	}


</%init>
