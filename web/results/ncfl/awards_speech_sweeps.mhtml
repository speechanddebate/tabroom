<%args>
	$tourn
	$session
</%args>
<%init>

	my @schools;
	my %sweeps_by_school = ();
	my $sweeps_points_ref;

	($sweeps_points_ref, @schools) 
		= $m->comp("/results/ncfl/speech_sweeps.mas", tourn => $tourn);

	%sweeps_by_school = %$sweeps_points_ref;

    my $filename = "SpeechSweeps-".$tourn->id."-".$session->id;
    my $filepath = $Tab::file_root."/tmp/".$filename;
	my $garbage = `rm -f $filepath.*`;

	open (TEXOUT, ">$filepath.tex");

print TEXOUT <<"EOF";
\\documentclass[11pt]{report}
\\usepackage{fullpage}
\\usepackage{colortbl}
\\usepackage{helvet}
\\usepackage{nopageno}
\\renewcommand{\\familydefault}{\\sfdefault}
\\renewcommand{\\arraystretch}{1.7}
\\begin{document}

\\setlength{\\oddsidemargin}{-.5in}     
\\setlength{\\textwidth}{6.5in}        

\\setlength{\\textheight}{9in}       
\\setlength{\\topmargin}{-.25in}      
\\setlength{\\headsep}{0in}         

\\setlength{\\parskip}{1.4ex}
\\setlength{\\parindent}{0mm}

\\begin{center}
\\normalsize

EOF

	print TEXOUT "\\bigskip \n";
	print TEXOUT "\\Large The Founders Awards of Excellence in Speech \\\\ \n";
	print TEXOUT "\\bigskip \n";
	print TEXOUT "\\large ".$tourn->name."\\\\ \n";
	print TEXOUT "\\bigskip \n";
	print TEXOUT "\\normalsize\n";

	my @top_five;

	foreach (1 .. 5) { 
		push (@top_five, shift @schools);
	}

	@top_five = sort {$a->name cmp $b->name} @top_five;

	my $switch;
	print TEXOUT "\\begin{tabular}{p{2.5in}p{2in}p{1in}}\n";

	foreach my $school (@top_five) { 
		print TEXOUT "\\rowcolor[rgb]{.84,.89,.94}\[5.5pt\]\[5.5pt\]\n"  if ($switch++ % 2);
		print TEXOUT $school->name." & ";
		print TEXOUT $school->region->name." & ";
		print TEXOUT $school->region->code."\\\\ \n";
	}

	print TEXOUT "\\end{tabular}\n";
	print TEXOUT "\\end{center}\n";
	print TEXOUT "\\end{document}\n";

	close TEXOUT;

	$garbage = `cd $Tab::file_root/tmp; $Tab::latex_path $filepath.tex; $Tab::dvipdfm_path $filepath.dvi`;
#	$garbage = `rm -f $filepath.tex $filepath.log $filepath.dvi $filepath.aux`;
	$m->redirect("$Tab::url_prefix/tmp/$filename.pdf");

</%init>
