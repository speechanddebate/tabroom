<%args>
	$tourn
	$group_id
	$league
	$sort_by => "code"
</%args>
<%init>

	my $group = Tab::JudgeGroup->retrieve($group_id); 

	my @judges = Tab::Judge->search( judge_group => $group_id );

	my @events = $group->events;

	@judges = sort {$a->last cmp $b->last} @judges;
	@judges = sort {$a->code cmp $b->code} @judges unless $sort_by eq "last";
	@judges = sort {$a->first cmp $b->first} @judges if $sort_by eq "first";
	@judges = sort {$a->school->name cmp $b->school->name} @judges if $sort_by eq "schname"; 
	@judges = sort {$a->region->name cmp $b->region->name} @judges if $sort_by eq "regname"; 
	@judges = sort {$a->region->code cmp $b->region->code} @judges if $sort_by eq "regcode"; 
	@judges = sort {$a->prelim_pool->name cmp $b->prelim_pool->name} @judges if $sort_by eq "prelim_pool"; 

</%init>

	<& sidebar.mas, tourn => $tourn, whoami => "roster", group => $group &>

<div id="leftbignb">

	<h2> <% $group->name %> Judges </h2>

	<table cellpadding="5" cellspacing="1"  border="0" width="100%">

		<tr class="liblrow">

			<th>
				<a class="whiteblock" href="roster.mhtml?group_id=<% $group->id %>&sort_by=code">
				Code
				</a>
			</th>

			<th>
				<a class="whiteblock" href="roster.mhtml?group_id=<% $group->id %>&sort_by=last">
				Last
				</a>
			</th>

			<th>
				<a class="whiteblock" href="roster.mhtml?group_id=<% $group->id %>&sort_by=first">
				First
				</a>
			</th>

			<th>
				<a class="whiteblock" href="roster.mhtml?group_id=<% $group->id %>&sort_by=schname">
				School
				</a>
			</th>

%			$m->print("<th>Regcode</th>") if $league->region_based;

%			$m->print("<th>Diocode</th>") if $league->diocese_based;

			<th>
				Notes/Special Job
			</th>

		</tr>

% 		my $switch;

%		foreach my $judge (@judges) { 

%			if ($judge->active) { 
				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""  %>> 
% 			} else { 
				<tr <% ($switch++ % 2) ? "class=\"bluerow\"" : "class=\"liblrow\""  %>> 
%			}

			<td align="center">
				<a class="whiteblock" href="<%$Tab::url_prefix%>/register/judge_edit.mhtml?from=list&judge_id=<% $judge->id %>"><% ($judge->code) ? $judge->code : "Edit"%></a>
			</td>

			<td class="smaller">
				<% $judge->last %>
			</td>

			<td class="smaller">
				<% $judge->first %>
			</td>

			<td class="smaller">
				<% ($judge->neutral) ? "NEUTRAL (" : "" %>
				<% ($judge->school->name) ? substr($judge->school->name,0,25) : "Hired" %>
				<% ($judge->neutral) ? " )" : "" %>
			</td>

				<% ($league->diocese_based && $judge->region) ? "<td class=\"smaller\" align=\"center\">".$judge->region->code."</td><td class=\"smaller\" align=\"center\">" : "" %>
				<% ($league->diocese_based &! $group->tab_room) ? ($judge->prelim_pool) ? $judge->prelim_pool->name : $judge->judge_group->abbr : "" %>
				<% ($league->diocese_based) ? "</td>" : "" %>

			<td width="20%" class="smaller">
				<% $judge->notes %>
				<% $judge->special %>
			</td>

		</tr>

% 		} 

	</table>

</div>

