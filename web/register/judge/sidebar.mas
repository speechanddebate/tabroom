<%args>
	$tourn
	$group => undef
	$roster => undef
	$drops => undef
	$hires => undef
	$whoami => undef
</%args>
<%init>

	my @groups = sort {$a->name cmp $b->name} $tourn->groups;

</%init>

	<div class="right small">

%		if ($group) { 
		
			<div class="sidenote">

				<h4><% $group->abbr %></h4>

					<a class="<% ($whoami || $drops || $hires) ? "" : "dk" %>blue halfblock" href="roster.mhtml?group_id=<% $group->id %>">
						All Judges
					</a><a class="<% ($whoami eq "add") ? "dk" : "" %>blue halfblock" href="add.mhtml?group_id=<% $group->id %>">
						Add Judges
					</a>

					<a class="<% ($hires) ? "dkblue" : "blue" %> halfblock" href="roster.mhtml?group_id=<% $group->id %>&hires=1">
						Hires Only
					</a><a class="<% ($drops) ? "dkblue" : "blue" %> halfblock" href="roster.mhtml?group_id=<% $group->id %>&drops=1">
						Drops Only
					</a>

%					if ($group->setting("track_judge_hires")) { 
						<a class="<% ($whoami eq "reqs") ? "dk" : "" %>blue block" href="hire_requests.mhtml?group_id=<% $group->id %>">
							Hire Requests
						</a>
%					}

%					if ($group->setting("rounds_per")) { 
						<a class="<% ($whoami eq "reqs") ? "dk" : "" %>blue block" href="rounds.mhtml?group_id=<% $group->id %>">
							Round Obligations
						</a>
%					}

%					if ($group->setting("tab_ratings")) { 
						<a class="<% ($whoami eq "reqs") ? "dk" : "" %>blue block" href="tab_ratings.mhtml?group_id=<% $group->id %>">
							Judge Ratings
						</a>
%					}

%					if ($group->setting("track_diversity")) { 
						<a class="<% ($whoami eq "reqs") ? "dk" : "" %>blue block" href="diversity.mhtml?group_id=<% $group->id %>">
							Diversity Designations
						</a>
%					}

%					if ( $group->setting("conflicts") || $group->setting("prefs") || $group->setting("entry_strikes") || $group->setting("school_strikes") ) { 

%						if ($group->setting("conflicts")) { 
							<a class="<% ($whoami eq "conflicts") ? "dkblue" : "blue" %> block" href="conflicts.mhtml?group_id=<% $group->id %>">
								Conflicts
							</a>
%						}

%						if ($group->setting("entry_strikes") || $group->setting("school_strikes")) { 
							<a class="<% ($whoami eq "strikes") ? "dkblue" : "blue" %> block" href="strikes.mhtml?group_id=<% $group->id %>">
								Strikes
							</a>
%						}

%						my $pref_style = $group->setting("prefs");

%						if ($group->setting("entry_strikes") || $group->setting("school_strikes") || $pref_style eq "tiered" || $pref_style eq "tiered_round" || $pref_style eq "caps" ) {
							<a class="<% ($whoami eq "strikes") ? "dkblue" : "blue" %> block" href="free_strikes.mhtml?group_id=<% $group->id %>">
								Designate Free Strikes
							</a>
%						}

%						if ($pref_style && $pref_style ne "none") { 
							<a class="<% ($whoami eq "prefs") ? "dkblue" : "blue" %> block" href="pref_report.mhtml?group_id=<% $group->id %>">
								Pref Report
							</a>
%						}

%					}

%					if ($group->setting("tab_room")) { 
						<a class="<% ($whoami eq "tab") ? "dkblue" : "blue" %> block" href="tab_room.mhtml?group_id=<% $group->id %>">
							Tab Room Assignments
						</a>
%					}
					

				<h4>Printouts</h4>

					<a class="blue block" href="print.mhtml?group_id=<% $group->id %>&drops=<% $drops %>&hires=<% $hires %>">
						Judge Roster (PDF)
					</a>

%					if ($group->setting("judge_contacts")) { 
						<a class="<% $whoami eq "contacts" ? "dk" : "" %>blue halfblock" href="contacts.mhtml?group_id=<% $group->id %>&drops=<% $drops %>&hires=<% $hires %>">
							Contact Info
						</a><a class="blue halfblock" href="print_contacts.mhtml?group_id=<% $group->id %>&drops=<% $drops %>&hires=<% $hires %>">
							PDF
						</a>
%					}

					<a class="blue block" href="csv.mhtml?group_id=<% $group->id %>&drops=<% $drops %>&hires=<% $hires %>">
						CSV Spreadsheet
					</a>


%				if ($m->comp("/funclib/group_online_balloting.mas", group => $group)) { 

					<h4>Online Ballots</h4>

						<a class="<% ($whoami eq "link") ? "dk" : "" %>blue block" href="link_accounts.mhtml?group_id=<% $group->id %>">
							Link Judges to Online Accounts
						</a>

%					if ($m->comp("/funclib/judge_requests.mas", tourn => $tourn)) { 
						<a class="dkred block" href="requests.mhtml">
							Judge access requests
						</a>
%					}

%				}

			</div>

%		}

		<div class="sidenote">

			<h4>Groups</h4>

%			foreach my $jgroup ($tourn->groups) { 
	
				<a class="<% ($group && $jgroup->id == $group->id) ? "dkblue" : "blue" %> block" href="roster.mhtml?group_id=<% $jgroup->id %>">
					<% $jgroup->name %>
				</a>

%			}

		</div>

		<div class="sidenote">

			<h4>All Judges</h4>

%			if ($group) { 
				<a class="blue block" href="index.mhtml">
					Return to Judge Master
				</a>
%			}

			<a class="yellow halfblock" href="csv.mhtml">
				All CSV
			</a><a class="yellow halfblock" href="print.mhtml">
				Print
			</a>

			<a class="yellow halfblock" href="csv.mhtml?drops=1">
				Drops CSV
			</a><a class="yellow halfblock" href="print.mhtml?drops=1">
				Print
			</a>

			<a class="yellow halfblock" href="csv.mhtml?hires=1">
				Hires CSV
			</a><a class="yellow halfblock" href="print.mhtml?hires=1">
				Print
			</a>

			<a class="yellow halfblock" href="seasonal_round_counts.mhtml?tourn_id=<% $tourn->id %>">
				Seasonal Round Totals
			</a>

			<a class="<% $whoami eq "check_burdens" ? "dkblue" : "yellow" %> block" href="check_burdens.mhtml">
				Check School Judging Burdens
			</a>

%			if ($m->comp('/funclib/tourn_exchange.mas', tourn => $tourn)) { 
				<a class="<% ($whoami eq "exchange") ? "dk" : "" %>blue block" href="hire_exchange.mhtml">
					Hiring Exchange
				</a>
%			}

%			if ($m->comp("/funclib/tourn_account_requests.mas", tourn => $tourn)) { 
				<br />
				<a class="dkgreen block" href="account_requests.mhtml">
					Judge Account Requests
				</a>
%			}

		</div>

	</div>
