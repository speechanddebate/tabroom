<%args>
	$circuit
	$tourn
</%args>
<%init>

	my @moves = Tab::Change->search( 
		tournament => $tourn->id, 
		type => "registration", 
		{order_by => 'timestamp'}
	);

	my $switch; 

</%init>

	<table width="100%">

		<tr> 
			
			<td width="100%">
				<h3>Registration Log</h3>
			</td> 
			
			<td>
				<form action="clear_reg_log.mas" method="post">
				<input type="submit" value="Clear Log of All Records">
				</form>
			</td>
			
		</tr>
		
	</table> 
	
	<table cellpadding="5" cellspacing="1" width="100%"> 
	
		<tr class="liblrow">
		
			<th colspan="2">
				When
			</th>
			
			<th>
				School
			</th>
			
			<th>
				Change
			</th>
			
			<td>
			</td>

		</tr>

% 		foreach my $move (@moves) { 

%			next unless $move->school && $move->school->id;

%			my $timestamp = $move->timestamp;
%			$timestamp->set_time_zone($tourn->tz);

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td class="smaller">
					<% &Tab::niceshortdate($timestamp) %>
				</td>
				
				<td class="smaller">
					<% &Tab::nicetime($timestamp) %>
				</td> 
				
				<td class="smaller">
					<a href="/register/registration.mhtml?school_id=<% $move->school->id %>"><% $move->school->name %></a>
				</td> 
				
				<td class="smaller">
					<% $move->regline %>
				</td> 
				
				<th style="text-align: center" class="smaller">
					(<a href="change_rm.mas?change_id=<% $move->id %>">Delete</a>)
				</td> 
				
			</tr>

%		}

	</table>

