<%args>
	$circuit
	$tourn
	$account
</%args>

<%init>
	
	my $filename = $Tab::file_root."/tmp/tourn-contact-sheet-".$tourn->id;
	my $garbage = `rm -f $filename.*`;
	
	open (TEXOUT, ">$filename.tex");

	print TEXOUT <<"EOF";
\\documentclass[10pt]{report}
\\usepackage{fullpage}
\\usepackage{helvet}
\\renewcommand{\\familydefault}{\\sfdefault}
\\renewcommand{\\arraystretch}{1.3}

\\addtolength{\\textwidth}{1in}
\\addtolength{\\hoffset}{-.5in}

\\begin{document}
\\begin{center}

EOF
	print TEXOUT "{\\huge ". &Tab::texify($tourn->name) ." Judge Contact Sheet }\\\\ \n";

	print TEXOUT "\\normalsize\n";
	print TEXOUT "\\begin{tabular}{|p{.5in}|p{.5in}|p{2.0in}|p{2.0in}|p{1.0in}|}\n";
	print TEXOUT "\\multicolumn{4}{l}{\\large}\\\\\n";
	print TEXOUT "\\hline \n";
	print TEXOUT "Group & Code & Name & School & Phone \\\\ \n";
	print TEXOUT "\\hline \n";
	print TEXOUT "\\end{tabular}\n\\\\ \n";
	
	my @judges = $tourn->judges;

	@judges = sort {$a->code cmp $b->code} @judges;
	@judges = sort {$a->judge_group->abbr cmp $b->judge_group->abbr} @judges;


foreach my $judge (@judges) { 
	print TEXOUT "\\begin{tabular}{|p{.5in}|p{.5in}|p{2.0in}|p{2.0in}|p{1.0in}|}\n";
	print TEXOUT "\\hline \n";
	print TEXOUT &Tab::texify($judge->judge_group->abbr)." & ";
	print TEXOUT &Tab::texify($judge->code)." & ";
	print TEXOUT &Tab::texify($judge->first."  ".$judge->last)." & ";
	print TEXOUT &Tab::texify($judge->school->name) if $judge->school->id;
	print TEXOUT " HIRED " unless $judge->school->id;
	print TEXOUT " & ".&Tab::texify($judge->cell);
	print TEXOUT "\\\\ \n";
	print TEXOUT "\\hline \n";
	print TEXOUT "\\end{tabular}\n\\\\ \n";
}

	print TEXOUT "\\end{center}\n";
	print TEXOUT "\\end{document}\n";
	close TEXOUT;


$garbage = `cd $Tab::file_root/tmp; $Tab::latex_path $filename.tex; $Tab::dvipdfm_path $filename.dvi`;

`rm -f $filename.tex $filename.log $filename.dvi $filename.aux`;

my $tourn_id = $tourn->id;
$m->redirect("$Tab::url_prefix/tmp/tourn-contact-sheet-$tourn_id.pdf");

</%init>

<div id="content">

<p><% $filename %></p>
