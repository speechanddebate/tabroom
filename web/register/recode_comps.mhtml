<%args>
	$circuit
	$tourn
	$err => undef
	$class => undef
</%args>
<%init>

	my $switch; 

</%init>

	
	<h2>Recode events</h2>

	<div class="left huge">

		<table cellpadding="6" width="100%" cellspacing="1">

		<tr class="bluerow">

			<th>
				Event
			</th>

			<th style="text-align: center;">
				Low Code
			</th>

			<th style="text-align: center;">
				High Code
			</th>

			<th>
				Start with:
			</th>

			<th>
				Sort by:
			</th>

			<th>
			</th>

		</tr>

%		foreach my $event ( sort {$a->name cmp $b->name} $m->comp("/funclib/tourn_events.mas", tourn => $tourn)) { 

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<td>
					<form action="event_recode.mas" method="post">
					<input type="hidden" name="event_id" value="<% $event->id %>">

					<a href="<% $Tab::url_prefix %>/register/event_listing.mhtml?event_id=<% $event->id %>">
						<% $event->name %>
					</a>
				</td>

				<td align="right" style="padding-right: 15px">
					<% Tab::Entry->sql_lowest_code->select_val($event->id) %>
				</td>

				<td align="right" style="padding-right: 15px">
					<% Tab::Entry->sql_highest_code->select_val($event->id) %>
				</td>

				<td align="center">	
					<input type="text" name="codestart" value="<% $event->code %>" size="3">
				</td>

				<td align="center">	
					<select name="sort_by">
						<option value="Randomly">Randomly</option>
						<option value="School">School</option>
						<option value="Name">Name</option>
	
%						if ($tourn->setting("ncfl") | $tourn->setting("regions")) { 
							<option value="<% ($tourn->setting("ncfl")) ? "Diocese" : "Region" %>">
								<% ($tourn->setting("ncfl")) ? "Diocese" : "Region" %>
							</option>
%						}

				</td>

				<td align="center">	
					<input  type="submit" value="Recode">
					</form>
				</td>

			</tr>

%		}

		</table>

	</div>


	<& "reports_menu.mas", class => $class, circuit => $circuit &>
