<%args>
	$circuit
	$tourn
	$err => undef
	$class => undef
</%args>
<%init>

	my $switch; 

</%init>

	<& "data_menu.mas", whoami => "entry_recode" &>
	
	<h2>Recode events</h2>

	<div class="left huge">

		<table cellpadding="6" width="100%" cellspacing="1">

		<tr class="bluerow">

			<th>
				Event
			</th>

			<th class="centeralign">
				Lowest
			</th>

			<th class="centeralign">
				Highest
			</th>

			<th>
				Start with:
			</th>

			<th>
				Sort by:
			</th>

			<th>
			</th>

		</tr>

%		foreach my $event ( sort {$a->name cmp $b->name} $m->comp("/funclib/tourn_events.mas", tourn => $tourn)) { 

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<td>
					<form action="entry_recode_save.mhtml" method="post">
					<input type="hidden" name="event_id" value="<% $event->id %>">

					<a class="white block" href="<% $Tab::url_prefix %>/register/event/roster.mhtml?event_id=<% $event->id %>">
						<% $event->name %>
					</a>
				</td>

				<td class="centeralign">
					<% $m->comp("/funclib/event_code.mas", min => 1, event => $event) %>
				</td>

				<td class="centeralign">
					<% $m->comp("/funclib/event_code.mas", max => 1, event => $event) %>
				</td>

				<td class="centeralign">
					<input type="text" name="codestart" value="<% $event->setting("code_start") %>" size="3">
				</td>

				<td class="centeralign">
					<select name="sort_by">
						<option value="School">By School</option>
						<option value="Randomly">Randomly</option>
						<option value="Initials">Set Entry Initials (Debate)</option>
	
%						if ($tourn->setting("ncfl") | $tourn->setting("regions")) { 
							<option value="<% ($tourn->setting("ncfl")) ? "Diocese" : "Region" %>">
								<% ($tourn->setting("ncfl")) ? "Diocese" : "Region" %>
							</option>
%						}

				</td>

				<td align="center">	
					<input  type="submit" value="Recode">
					</form>
				</td>

			</tr>

%		}

		</table>

	</div>

