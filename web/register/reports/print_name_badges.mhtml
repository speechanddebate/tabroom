<%args>
	$circuit
	$session
	$tourn
	$debug
</%args>
<%init>

	my @judge_groups = $tourn->groups(tab_room => 1);

    #Set up the filename and the needed trace files
	my $filename = "NameCards-".$tourn->id."-".$session->id;
	my $filepath = $Tab::file_root."/tmp/";
	my $garbage = `rm -f $filepath"."$filename.*`;
	open (TEXOUT, ">$filepath"."$filename.tex");

    print TEXOUT <<'EOF';

		\documentclass[10pt]{report}
		\usepackage{nopageno}
		\usepackage{multirow}
		\usepackage{hyphenat}
		\usepackage[pdftex]{graphicx}
		\renewcommand{\arraystretch}{1.8}

		\setlength{\oddsidemargin}{-.13in}     
		\setlength{\textwidth}{6.0in}        

		\setlength{\textheight}{10in}       
		\setlength{\topmargin}{0in}      
		\setlength{\headsep}{0in}         

		\setlength{\parskip}{1.4ex}
		\setlength{\parindent}{0mm}

		\begin{document}
EOF

	my $switch;

	foreach my $judge_group (@judge_groups) { 

		foreach my $judge (sort {$a->code <=> $b->code} $judge_group->judges) { 

			print TEXOUT "\\begin{tabular}{p{1.0in}p{2.15in}}\n";
	
			print TEXOUT "\\multirow{3}{*}{ ";
			print TEXOUT "\\includegraphics[width=.90in]{/www/tab/lib/images/ncfl-logo.png}";
			print TEXOUT " } \n";

			print TEXOUT " & \\Large \\nohyphens{".&Tab::texify($judge->first." ".$judge->last)."}\\\\ \n";
			print TEXOUT " & \\\\ \n";
			print TEXOUT " & \\Large ".&Tab::texify($judge->school->region->name)."\\\\ \n";
			print TEXOUT "\\multicolumn{1}{c}{ \\small \\it ".$tourn->start->year." } & \\\\ \n";
			print TEXOUT "\\multicolumn{1}{c}{ \\small \\it ".Tab::texify($tourn->name)." } & ";
			print TEXOUT "\\normalsize ".&Tab::texify($judge->school->name)."\\\\ \n";
			print TEXOUT "\\end{tabular}\n";
	
#			print TEXOUT "\\hspace{.0in}\n" unless ($switch % 2);
			print TEXOUT "\\vspace{.70in}\n" if ($switch % 2);
			print TEXOUT "\\newline\n" if ($switch++ % 2);

		}
	}

	print TEXOUT "\\end{document}\n";

    close TEXOUT;

    $garbage = `cd $filepath; $Tab::latex_path $filename.tex;`;
	$garbage = `cd $filepath; rm -f $filename.tex $filename.log $filename.dvi $filename.aux` if $debug;
    $m->redirect("$Tab::url_prefix/tmp/$filename.pdf");

</%init>
