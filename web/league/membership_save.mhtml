<%args>
	$circuit
	$name => "Circuit Membership"
	$membership_id => undef
	$dues => undef
	$text => undef
	$approval => undef
</%args>
<%init>

	my $err;

	my $membership = Tab::Membership->retrieve($membership_id) if $membership_id;

	if ($membership) { 

		$membership->name($name);
		$membership->dues($dues);
		$membership->text($text);
		$membership->approval($approval);

		$membership->update;

		$err = $membership->name." has been updated";

	} else { 

		$membership = Tab::Membership->create({
			name => $name,
			dues => $dues,
			text => $text,
			circuit => $circuit->id,
			approval => $approval
		});

	}

	$m->redirect("$Tab::approval_prefix/circuit/membership_edit.mhtml?membership_id=".$membership->id."&err=$err");

</%init>

