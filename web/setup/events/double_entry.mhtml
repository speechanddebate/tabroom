<%args>
	$tourn
	$account
</%args>

  
	<script>

		$(function() {
			$(".click").editable("/setup/events/double_entry_namesave.mhtml", { 
				loadurl   	: "http://www.appelsiini.net/projects/jeditable/php/load.php",
				tooltip   	: "Click to edit...",
				indicator 	: 'Saving...',
				style  		: "inherit"
			});
		});

	</script>

%	my $method = $tourn->method;

    <div class="right small"> 
		<& menu.mas, tourn => $tourn, whoami => "double" &> 
	</div> 
	
	<div class="left huge">
		
		<h2>Double Entry</h2>

			<form action="double_settings_save.mhtml">
			<span class="spacey">	
				Double Entry Allowed:
			</span>

			<span class="spacey" align="right" style="text-align: right; width: 200px;"> 

				<select name="double_entry"> 
					
					<option value="none" <% ($method) ? ($method->double_entry eq "none") ? "selected" : "" : "" %>>
						No Double Entry Allowed
					</option> 
					
					<option value="max_events" <% ($method) ? ($method->double_entry eq "max_events") ? "selected" : "" : "" %>>
						Allow to maximum of ->
					</option> 

                    <option value="unlimited" <% ($method) ? ($method->double_entry eq "unlimited") ? "selected" : "" : "" %>>
						Unlimited Double Entry
					</option> 
					
				</select> 

			</span>

				<span class="spacey" align="right" style="text-align: right; width: 135px;"> 
					Maximum: 
					<input type="number" name="double_max" value="<% ($method) ? $method->double_max : "" %>" size="3" min=0 max=100>
				</span>

			<h4>Groupings</h4>
			
			<table cellpadding="6" cellspacing="1" width="100%">

%				my $switch;

%				foreach my $class (sort {$a->name cmp $b->name} $tourn->classes) { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>		
							
						<td class="smaller">
							<b class="click" style="display: inline" id=<% $class->id%> value="<% $class->name %>" name="class_name">
							<% $class->name %>
							</b>
						</th>

						<td class="smaller" align="right">  

							<span class="spacey">
								None <input type="radio" name="<% $class->id %>" value="2" <% ($class->double_entry == 2) ? "checked" : ""%>>
							</span>

							<span class="spacey">
								Unlimited <input type="radio" name="<% $class->id %>" value="0" <% ($class->double_entry == 0) ? "checked" : ""%>>
							</span>

							<span class="spacey">
								None within group <input type="radio" name="<% $class->id %>" value="1" <% ($class->double_entry == 1) ? "checked" : ""%>>
							</span>

							<span class="spacey">
								Max 
								<input type="number" name="max_<% $class->id %>" value="<% $class->max %>" min=0 max=100 size=3>
								events
								<input type="radio" name="<% $class->id %>" value="3" <% ($class->double_entry == 3) ? "checked" : ""%>>
							</span>

						</td>

						<td>
							<a class="whiteblock" href="class_rm.mhtml?class_id=<% $class->id %>">
							[X]
							</a>
						</td>

					</tr>

%				}

				<tr class="liblrow">

					<td align="center">
						<a class="whiteblock" href="class_add.mhtml">
							[Add]
						</a>
					</td>

					<td colspan="2" align="right">
						<input type="submit" value="Save Double Entry Settings" >
						</form>
					</td>
				</tr>

			</table>

			<h3>Events</h3>
			<form action="double_groupings_save.mhtml">

			<table cellpadding="6" cellspacing="1" width="100%">

%				foreach my $event (sort {$a->name cmp $b->name} $tourn->events) { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>		

						<th class="smaller">
							<% $event->name %>
						</th>

						<td  align="right">
							<select name="<% $event->id %>">

								<option value="">----</option>

%								foreach my $class (sort {$a->name cmp $b->name} $tourn->classes) { 
									<option value="<% $class->id %>" <% ($event->class && $event->class->id == $class->id) ? "selected" : "" %>> 
										<% $class->name %>
									</option>
%								}
						</td>

					</tr>

%				}

				<tr class="liblrow">
					<td colspan="2" align="right">
						<input type="submit"  value="Save Event Groupings">
						</form>
					</td>
				</tr>

			</table>

	</div>

	
