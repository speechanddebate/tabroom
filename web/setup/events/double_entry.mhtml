<%args>
	$tourn
	$account
</%args>

%	my $switch;

	<script>

		$(function() {
			$(".click").editable("/setup/events/double_entry_namesave.mhtml", { 
				loadurl   	: "http://www.appelsiini.net/projects/jeditable/php/load.php",
				tooltip   	: "Click to edit...",
				indicator 	: 'Saving...',
				style  		: "inherit"
			});
		});

	</script>

    <div class="right small"> 
		<& menu.mas, tourn => $tourn, whoami => "double" &> 
	</div> 
	
	<div class="left huge">
		
		<h2>Double Entry</h2>

			<table cellpadding="8" cellspacing="1" width="100%">
					
				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>		

					<td> 
						<form action="double_settings_save.mhtml">
							Tournament-wide limit:
					</td>

					<td> 
						<select name="double_entry"> 
					
						<option value="none" <% ($tourn->setting("double_entry") eq "none") ? "selected" : "" %>>
							No Double Entry Allowed
						</option> 
					
						<option value="max_events" <% ($tourn->setting("double_entry") eq "max_events") ? "selected" : ""  %>>
							Allow to maximum of ->
						</option> 
	
						<option value="unlimited" <% ($tourn->setting("double_entry") eq "unlimited") ? "selected" : "" %>>
							Unlimited Double Entry
						</option> 
					
						</select> 
					</td>

					<td>
						Maximum: 
					</td>

					<td>
						<input type="number" name="double_max" value="<% $tourn->setting("double_max") %>" size="3" min=0 max=100>
					</td>

				</tr>

			</table>

		<h4>Mutually Exclusive Groups</h4>
			
		<table cellpadding="6" cellspacing="1" width="100%">


%				foreach my $event_double (sort {$a->name cmp $b->name} $tourn->event_doubles) { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>		
							
						<td>
							<b class="click" style="display: inline" id=<% $event_double->id %> value="<% $event_double->name %>" name="event_double_name">
							<% $event_double->name %>
							</b>
						</th>

						<td class="smaller" align="right">  

							<span class="spacey">
								<label for="<% $event_double->id%>_2">
								None 
								<input type="radio" id="<% $event_double->id%>_2" name="<% $event_double->id %>" 
									value="2" <% ($event_double->setting == 2) ? "checked" : ""%>>
								</label>
							</span>

							<span class="spacey">
								<label for="<% $event_double->id%>_0">
								Unlimited <input type="radio" id="<% $event_double->id%>_0" name="<% $event_double->id %>" 
									value="0" <% ($event_double->setting == 0) ? "checked" : ""%>>
								</label>
							</span>

							<span class="spacey">
								<label for="<% $event_double->id%>_1">
								None within group 
								<input type="radio" id="<% $event_double->id%>_1" name="<% $event_double->id %>" 
									value="1" <% ($event_double->setting == 1) ? "checked" : ""%>>
								</label>
							</span>

							<span class="spacey">
								<label for="<% $event_double->id%>_3">
								Max 
								<input type="number" name="max_<% $event_double->id %>" value="<% $event_double->max %>" min=0 max=100 size=3>
								events
								<input type="radio" id="<% $event_double->id%>_3" name="<% $event_double->id %>" 
									value="3" <% ($event_double->setting == 3) ? "checked" : ""%>>
								</label>
							</span>

						</td>

						<td>
							<a class="dkred block" href="event_double_rm.mhtml?event_double_id=<% $event_double->id %>">
							Delete
							</a>
						</td>

					</tr>

%				}

				<tr class="liblrow">

					<td align="center">
						<a class="dkgreen block" href="event_double_add.mhtml">
							Add New
						</a>
					</td>

					<td colspan="2" align="right">
						<input type="submit" value="Save Double Entry Settings" >
						</form>
					</td>
				</tr>

			</table>

			<h4>Events</h4>

%			undef($switch);

			<form action="double_groupings_save.mhtml">

			<table cellpadding="6" cellspacing="1" width="100%">

%				foreach my $event (sort {$a->name cmp $b->name} $tourn->events) { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>		

						<th class="smaller">
							<% $event->name %>
						</th>

						<td  align="right">
							<select name="<% $event->id %>">

								<option value="">----</option>

%								foreach my $event_double (sort {$a->name cmp $b->name} $tourn->event_doubles) { 
									<option value="<% $event_double->id %>" <% ($event->event_double && $event->event_double->id == $event_double->id) ? "selected" : "" %>> 
										<% $event_double->name %>
									</option>
%								}
						</td>

					</tr>

%				}

				<tr class="liblrow">
					<td colspan="2" align="right">
						<input type="submit"  value="Save Event Groupings">
						</form>
					</td>
				</tr>

			</table>

	</div>

	
