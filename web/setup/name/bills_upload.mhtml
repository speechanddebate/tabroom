<%args>
	$account
	$tourn_id
	$bills => undef
</%args>
<%init>

	my $tourn = Tab::Tournament->retrieve($tourn_id);

    if ($bills) {
        my $req = Apache2::Request->new($r);
        my $upload = $req->upload("bills");
        my $filename  = $upload->filename;
        $filename =~ s/.*[\/\\](.*)/$1/;
        $filename =~ s/\ //g;
        $filename =~ s/\'//g;  # '  stupid vim
        my $filepath = "$Tab::file_root/files/tourns/".$tourn->id."/bills/";
        my $garbage = `rm -f $filepath`;
        $garbage = `mkdir -p $filepath`;
        my $filetemp = $upload->tempname;
        $garbage = `cp $filetemp $filepath/$filename`;
        $tourn->setting("bills", $filename);
	}

	my $err = "Bill packet uploaded";

	$m->redirect("edit.mhtml?err=$err");

</%init>

