<%args>
	$circuit
	$tourn
</%args>
<%init>

	my $method = $tourn->method;
	my $switch;

</%init>

	<& sidebar.mas, circuit => $circuit, chosen => "sweeps" &>

		<div class="left huge">

			<h2>Sweepstakes Calculations</h2>

			<table cellpadding="5" cellspacing="1" width="100%">

				<tr>
					<td colspan="4">
						<h4>Who counts for sweeps</h4>
						<form action="sweeps_save.mhtml" method="post">
					</td>
				</tr>

%	$switch = 1;

<tr class="lirdrow">
	<td colspan="4" class="smaller">
		These limit how many event entries count in sweeps.  Sweep by event
		classes to count the top X categories in classes of events, such as
		Reading, Address, etc etc.
	</td>
</tr>

<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Sweep based on</td>
    <td valign="top" width="10%" align="left">
			<input type="radio" name="sweep_class_based"  value=""
				<% ($method) ? ($method->sweep_class_based != 1) ? "checked" : "" : "" %> >Events
			<input type="radio" name="sweep_class_based"  value="1"
				<% ($method) ? ($method->sweep_class_based == 1) ? "checked" : "" : "" %> >Classes
    </td>
</tr>

<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Count how many entries per event or class:</td>
    <td valign="top" width="10%" align="left">
    <input type="text" name="sweep_per_event" value="<% ($method) ? $method->sweep_per_event : "" %>" size="5">
    </td>
</tr>


<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Count how many events or classes:</td>
    <td valign="top" width="10%" align="left">
    <input type="text" name="sweep_event_total" 
		value="<% ($method) ? $method->sweep_event_total : "" %>" size="5">
    </td>
</tr>

<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Count additional wildcards:</td>
    <td valign="top" width="10%" align="left">
    <input type="text" name="sweep_wildcards" 
		value="<% ($method) ? $method->sweep_wildcards : "" %>" size="5">
    </td>
</tr>

<tr>
	<td align="right" colspan="4">
	<input  type="submit" value="Save Settings">
	</td>
</tr>


<tr class="oddrow">
	<td colspan="4">
	</td>
</tr>


<tr class="liblrow">
	<td colspan="4">
		<h4>Sweep based on the 6 - rank formula</h4>
	</td>
</tr>

<tr class="lirdrow">
	<td colspan="4" class="smaller">
		These settings, in speech events, will calculate sweeptakes points on
		the 6-rank method (5 for a 1, 4 for a 2, etc).  Ranks are each ballot's
		ranks, placement is the student's place overall in a multi-judge round.
	</td>
</tr>

<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
	<td valign="top" width="40%">Sweep prelim ranks:</td>
	<td valign="top" width="10%" align="left"><input type="checkbox" name="sweep_count_prelims"  value="1"
		<% ($method) ? ($method->sweep_count_prelims == 1) ? "checked" : "" : "" %> >
	</td>
</tr>

<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Sweep elim ranks:</td>
    <td valign="top" width="10%" align="left"><input type="checkbox" name="sweep_count_elims"  value="1"
        <% ($method) ? ($method->sweep_count_elims == 1) ? "checked" : "" : "" %> >
    </td>
</tr>

<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Sweep final ranks:</td>
    <td valign="top" width="10%" align="left"><input type="checkbox" name="sweep_count_finals"  value="1"
        <% ($method) ? ($method->sweep_count_finals == 1) ? "checked" : "" : "" %> >
    </td>
</tr>

<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Sweep elim & final round placements:</td>
    <td valign="top" width="10%" align="left"><input type="checkbox" name="sweep_rank_in_elims"  
		value="1" <% ($method) ? ($method->sweep_rank_in_elims == 1) ? "checked" : "" : "" %> >
    </td>
</tr>
<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    <td valign="top" width="40%">Sweep on final overall placement:</td>
    <td valign="top" width="10%" align="left"><input type="checkbox" name="sweep_final_rank"  value="1"
        <% ($method) ? ($method->sweep_final_rank == 1) ? "checked" : "" : "" %> >
    </td>
</tr>

<tr>
	<td align="right" colspan="4">
	<input  type="submit" value="Save Settings">
	</td>
</tr>

<tr class="oddrow">
	<td colspan="4">
	</td>
</tr>


<tr class="liblrow">
	<td colspan="4">
		<h4>Sweep based on placement/advancement</h4>
	</td>
</tr>

%	$switch = 1;


<tr> 
	<td valign="top" width="50%">

	<table cellpadding="3" cellspacing="1" width="100%">

	<tr class="lirdrow">
		<td colspan="3" class="smaller">
			Sweep based on a set amount of points for each tier/placement an entry reaches.
			Points are cumulative; if you give 1 point for an entry and 1 for an elim round,
			a student making the 2nd elim will get 3 points.
		</td>
	</tr>

		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		    <td valign="top" width="40%">Points per contestant:</td>
		    <td valign="top" width="10%" align="left">
		    <input type="text" name="points_per_entry" 
				value="<% ($method) ? $method->points_per_entry : "" %>" size="5">
		    </td>
		</tr>
	
		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		    <td valign="top" width="40%">Points per finalist:</td>
		    <td valign="top" width="10%" align="left">
		    <input type="text" name="points_per_finalist" 
				value="<% ($method) ? $method->points_per_finalist : "" %>" size="5">
		    </td>
		</tr>
	
		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		    <td valign="top" width="40%">Points per elim break:</td>
		    <td valign="top" width="10%" align="left">
		    <input type="text" name="points_per_elim" 
				value="<% ($method) ? $method->points_per_elim : "" %>" size="5">
		    </td>
		</tr>

		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

		    <td valign="top" width="40%" class="smaller">
				Only give placement points (at right) to finalists:
			</td>

		    <td valign="top" width="10%" align="left">
			    <input type="checkbox" name="sweep_only_place_final" value="1"
					<% ($method->sweep_only_place_final) ? "checked" : "" %> size="5">
		    </td>

		</tr>


		<tr>
			<td align="right" colspan="4">
				<input  type="submit" value="Save Settings">
				</form>
			</td>
		</tr>

	</table>

	</td><td width="50%" valign="top">

%	$switch = 1;

	<a name="end"></a>

	<table cellpadding="3" cellspacing="1" width="100%">

		<tr class="lirdrow">
			<td colspan="3" style="padding: 7px;">Placement points.  Use only numbers.</td>
		</tr>

		<form action="sweep_placement_save.mhtml" method="post">
		<input type="hidden" name="tourn_id" value="<% $tourn->id %>">
		<input type="hidden" name="type" value="place">

%		foreach my $sweep (sort {$a->place <=> $b->place} $tourn->sweeps) { 
%			next unless $sweep->place;

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
				<td></td>
				<td> Place:
					<input size="5" type="text" name="place_<% $sweep->id %>" value="<% $sweep->place %>">
				</td>

				<td>Points:
					<input size="5" type="text" name="value_<% $sweep->id %>" value="<% $sweep->value %>">
				</td>
			</tr>

%		}

		<tr class="liblrow">
			<th>Add:</th>

			<td>
				Place:
				<input type="text" size="5" name="place_new">
			</td>

			<td>
				Points:
				<input type="text" size="5" name="value_new">
			</td>
		</tr>

	<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		<td colspan="3" align="center" valign="middle">
			<input  type="submit" value="  Save Placement Sweeps ">
		</td>
		</form>
	</tr>

<tr class="oddrow">
	<td colspan="4">
	</td>
</tr>


</table>

<table cellpadding="3" cellspacing="1" width="100%">

	<tr class="lirdrow">
		<td colspan="3" style="padding: 7px;">Points for prelim cume totals.  Use only numbers.</td>

		<form action="sweep_placement_save.mhtml" method="post">
		<input type="hidden" name="tourn_id" value="<% $tourn->id %>">
		<input type="hidden" name="type" value="prelim_cume">

%		foreach my $sweep (sort {$a->prelim_cume <=> $b->prelim_cume} $tourn->sweeps) { 
%			next unless $sweep->prelim_cume;

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
				<td></td>
				<td> Cume:
					<input size="5" type="text" name="prelim_cume_<% $sweep->id %>" value="<% $sweep->prelim_cume %>">
				</td>

				<td>Points:
					<input size="5" type="text" name="value_<% $sweep->id %>" value="<% $sweep->value %>">
				</td>
			</tr>

%		}

		<tr class="liblrow">
			<th>Add:</th>

			<td>
				Cume:
				<input type="text" size="5" name="prelim_cume_new">
			</td>

			<td>
				Points:
				<input type="text" size="5" name="value_new">
			</td>
		</tr>

	<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		<td colspan="3" align="center" valign="middle">
			<input  type="submit" value="  Save Cumulative Sweeps ">
			</form>
		</td>
	</tr>

			<tr class="oddrow">
				<td colspan="4">
				</td>
			</tr>

			</table>

		</table>

	</div>
