<%args>
	$tourn
	$circuit
	$account
	$err => undef
</%args>
<%init>

	my $switch;

	my @tiebreakers = 	("ranks","winloss","reciprocals","points","judgepref","roundrank",
						 "panelletter","rankinround","competition",
						 "coinflip");

	my @counts = 		("all","prelim","elim","last elim","final");

	my $method = $tourn->method;

	my @sets = ("prelim", "elim", "final");

</%init> 

	<& sidebar.mas, circuit => $circuit, chosen => "tiebreaks" &>

	<div id="leftbignb">
			
		<h2>Tiebreaker sets for <% $tourn->name %></h2>

%		foreach my $set (@sets) { 

%			my $prime = 1;
		
			<span style="float: left; width: 525px;">
				<h4 style="margin-top: 10px;"><% ucfirst($set) %></h4>
			</span>

<!--
			<span style="float: left; width: 25px; padding-top: 15px">
				<a class="whiteblock" href="tiebreak_set_rm.mhtml?set_id= $set->id %>"> [X] </a>
			</span>
-->

			<table width="100%" cellpadding="4" cellspacing="1">

%   			foreach my $ptb (sort {$a->priority <=> $b->priority} Tab::Tiebreak->search(method => $method, covers => $set)) {

%					$prime++;

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

			            <td colspan="8">
							 <% $ptb->priority %>. <% ucfirst($ptb->tiebreaker) %> score
							 from <% $ptb->count %> rounds multiplied by <% $ptb->multiplier %>

							<span style="float: right; width: 150px; text-align: right;">
            			    	<a class="whiteblock" href="tiebreak_rm.mhtml?tiebreak_id=<% $ptb->id %>">[Delete]</a>
							</span>

						</td>
					</tr>
%				}

				<tr class="liblrow"> 
				
					<td>
						Add:
						<form action="tiebreak_save.mhtml" method="post">
						<input type="hidden" name="covers" value="<% $set %>">
					</td> 
					
					<td align="center">
						<select name="tiebreaker">
%               			foreach my $tb (@tiebreakers) {
                    			<option value="<% $tb %>"><% ucfirst($tb) %></option>
%               			}
           	 			</select>
        			</td> 
					
					<td align="center">
						<input type="number" min="1" max="99" size="4" name="priority" value="<% $prime %>" placeholder="Priority"> 
					</td> 
					
					<td>
						<select name="count">
%           				foreach my $ct (@counts) {
                				<option value="<% $ct %>"><% ucfirst($ct) %></option>
%           				}
            			</select>
        			</td>

					<td align="center">
						<input type="number" min="1" max="99" size="4" name="multiplier" placeholder="Multiplier">
					</td> 
					
					<td align="center">
						<input class="skinny" type="submit" value="Save">
						</form>
					</td>

				</tr>

			</table>

%		}

		<br />
		<hr />


<!--
		<table width="100%" cellpadding="5" cellspacing="1">

			<tr class="lirdrow">

				<td>
					Add new tiebreak set:
				</td>

				<td>
					<form action="tiebreak_set_save.mhtml" method="post">
					<input type="text" name="name" size="35" placeholder="Name of set, i.e. 'Debate Prelims'">
				</td>

				<td align="center">
					<input type="submit" value=" Save Set ">
					</form>
				</td>

			</tr>

		</table>
-->

	</div>

